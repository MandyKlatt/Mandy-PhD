---
title: "Through the eyes of the teacher - Multimodal exploration of expertise differences
  in the perception of classroom disruptions in a laboratory study"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

```{r include=FALSE}
# install.packages("needs")

# suppress "summarize" info. 
# if this line is ommitted, each table using the summarize function will be accompanied with a warning from the console
options(dplyr.summarise.inform = FALSE)

library(needs)
needs(tidyverse,
      lubridate,
      viridis,
      grid,
      gridExtra,
      cowplot,
      readxl,
      ARTofR,
      moments,
      ltm,
      sjPlot,
      kableExtra,
      xtable,
      DescTools,
      formattable,
      psych,
      apaTables,
      rstatix)

```

## 1. Participants
```{r demographicstable, include = TRUE, echo=FALSE}

# read in data and select and rename relevant columns with transmute 
demo.data <- 
  read_excel("./data/data_empschul_labor_lehrperson.xlsx") %>% 
  filter(!LI06_05 == 201,
         !LI06_05 == 223) %>% # exclude participant due to missing eye tracking data
  transmute(Group = LI06_05,
            Gender = LI02_01_1,
            Age = LI03_01,
            `Teaching Experience` = LI04_01,
            School_type = LI18,
            Grade = LI16_05,
            Subject = LI10_05,
            Semester = LI11_01,
            Internship = LI13_01,
            `Extracurricular Teaching Experience` = LI14,
            `Secondary Teaching Activities` = LI17
            )

# define expert and novice with ifelse function
demo.data$Group = ifelse(demo.data$Group < 200, "Novice","Expert")

# changing gender to count female gender (male = 2 --> 0)
demo.data$Gender = ifelse(demo.data$Gender == 2, "1","0")

# changing character Gender into numeric
demo.data$Gender <- as.numeric(demo.data$Gender)

# creating new column with total participants to calculate percent of gender
demo.data <- demo.data %>%
  group_by(Group) %>%
  mutate(Sum_participants = n())

# replacing 2 to 1 (Oberschule = Gymnasisium --> Secondary school)
demo.data$School_type[demo.data$School_type == 2] <- "1"

# creating new column to calculate percent of school type
demo.data <- 
  demo.data %>%
  group_by(School_type, Group) %>%
  mutate(Count_Schooltype = sum(n())) %>% 
  mutate(Percent_schooltype = round((Count_Schooltype/Sum_participants) * 100, 
         digits = 2))

# changing character Percent_schooltype into numeric
demo.data$Percent_schooltype <- as.numeric(demo.data$Percent_schooltype)

# changing character Semester into numeric
demo.data$Semester <- as.numeric(demo.data$Semester)


# changing Type of School into character
# LI18:
# 1: Grundschule
# 2: Oberschule
# 3: Gymnasium
# 4: Förderschule/Sondershausen
# 5: Berufsbildende Schule
# -1: andere Schulform
demo.data$School_type <- factor(x = demo.data$School_type,
                   levels = c("1","3","4","5","-1"), # Mögliche Werte # andere Möglichkeit: unique(demo.data$School_type)
                   labels = c("Primary School","Secondary School", "Special Education","Vocational School", "Other Schooltype")) # Bezeichnungen

# changing `Extracurricular Teaching Experience` to count experience (no experience = 2 --> 0)
demo.data$`Extracurricular Teaching Experience` = ifelse(demo.data$`Extracurricular Teaching Experience` == 1, "1","0")

# changing character Extra. Exp. into numeric
demo.data$`Extracurricular Teaching Experience` <- as.numeric(demo.data$`Extracurricular Teaching Experience`)

# changing `Secondary Teaching Activities` to count experience (no experience = 2 --> 0)
demo.data$`Secondary Teaching Activities` = ifelse(demo.data$`Secondary Teaching Activities` == 1, "1","0")

# changing character Extra. Exp. into numeric
demo.data$`Secondary Teaching Activities` <- as.numeric(demo.data$`Secondary Teaching Activities`)

# create new columns that give proportion of Gender
# percent = female gender divided by all female Gender
# demo.data <- demo.data  %>% 
#   group_by(Group) %>% 
#   mutate(Gender_percent = Gender/Sum_participants) %>% 
#   mutate(Gender_percent = round(sum(Gender_percent)*100, digits=0))

# create a basic table (tibble) using tidyverse functions
demo.table <- demo.data %>%
  group_by(Group) %>%
  summarise(N=n(),
            "Women in percent" = round(sum(Gender/Sum_participants) * 100, 
                                               digits = 2),
            "M Age in years" = round(mean(Age), 
                                     digits = 2),
            "SD Age in years" = round(sd(Age), 
                                      digits = 2),
            "Min Age in years" = min(Age),
            "Max Age in years" = max(Age),
            "M Exp." = round(mean(`Teaching Experience`), 2),
            "Median Exp." = round(median(`Teaching Experience`), 2),
            "SD Exp." = round(sd(`Teaching Experience`), 2),
            "Min Exp." = min(`Teaching Experience`),
            "Max Exp." = max(`Teaching Experience`)
            )

knitr::kable(demo.table,
             caption = "Demographic information & teaching experience")


# # create a basic table (tibble) using tidyverse functions
# exp.table <- demo.data %>%
#   group_by(Group) %>%
#   summarise(N=n(),
#            "M Exp." = round(mean(`Teaching Experience`), 2),
#             "SD Exp." = round(sd(`Teaching Experience`), 2),
#             "Min Exp." = min(`Teaching Experience`),
#             "Max Exp." = max(`Teaching Experience`),
#             "M Semester" = round(mean(Semester), 2),
#             "SD Semester" = round(sd(Semester), 2),
#             "Min Semester" = min(Semester),
#             "Max Semester" = max(Semester),
#             "M Internship" = round(mean(Internship), 2),
#             "SD Internship" = round(sd(Internship), 2),
#             "Min Internship" = min(Internship),
#             "Max Internship" = max(Internship),
#             "Extracurricular Teaching Experience" = round(sum(`Extracurricular Teaching Experience`/Sum_participants) * 100, digits = 2),
#             "Secondary Teaching Activities" = round(sum(`Secondary Teaching Activities`/Sum_participants) * 100)
#            )

```

## 2. Measures

### 2.1 Eye-Tracking Data
```{r eyetracking_read_in_data, echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}

# return a character vector with names of .tsv data in data folder
 file_names <- list.files(path = "data",
                          pattern = "interval_complete.tsv")

# read every object names in file_names and save it as a tibble
 for (i in file_names) {

   work_data <-
     read_tsv(file = paste0("data/", i),
              locale = locale(decimal_mark = ",")) %>%
     dplyr::select(Group,
                   Participant,
                   TOI,
                   Duration_of_interval,
                   Start_of_interval,
                   starts_with("Total_duration_of_fixations"),
                   starts_with("Average_duration_of_fixations"),
                   starts_with("Number_of_fixations"),
                   starts_with("Time_to_first_fixation")
     )

   assign(value = work_data,
          x = str_remove(paste0("tib_", i),
                         pattern = ".tsv"))

 }

# bind every tibble that contains "interval_complete" to a new tible
 df_aoi <-
   mget(ls(pattern = "interval_complete")) %>%
   bind_rows()

# extract only participants ID number
 df_aoi$Participant <- as.numeric(
   str_extract(df_aoi$Participant,
               "\\d{3}")
   )
 
# exclude invalid participants
df_aoi <- df_aoi %>%
  filter(!Participant == 223)

# remove temporary data for a cleaner workspace
 rm(list = ls(pattern = "^tib_ProVisio"))
 rm(work_data)
 rm(file_names)
 rm(i)

```

#### 2.2.1 Number of fixations per minute (micro-teaching unit)
```{r nof_all, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

##################### NUMBER OF FIXATION IN MICRO-TEACHING UNIT ########################

# filter group, participants, total duration & number fixation (micro-teaching unit)
df_aoi %>%
  filter(TOI == "Lesson") %>% 
  dplyr::select (
    Group,
    Participant,
    Duration_of_interval,
    starts_with("Total_duration_of_fixations"),
    starts_with("Number_of_fixations"),
    starts_with("Average_duration"),
    !"Total_duration_of_fixations.Disruptive_Person",
    !"Number_of_fixations.Disruptive_Person",
    !"Average_duration_of_fixations.Disruptive_Person"
  ) %>%
  rowwise() %>%
  transmute(
    Group = Group,
    Participant = Participant,
    Duration_of_interval = Duration_of_interval, 
    Duration_of_interval_min = round(Duration_of_interval/60000, digits = 2),
    Duration_of_interval_sec = round(Duration_of_interval/1000, digits = 2),
    Sum_duration_fixation = sum(c_across(starts_with("Total_duration")), na.rm = TRUE),
    Sum_average_duration_fixation = sum(c_across(starts_with("Average_duration")), na.rm = TRUE),
    Sum_number_fixation = sum(c_across(starts_with("Number_of")), na.rm = TRUE),
    Average_duration_mtu = round(Sum_duration_fixation / Sum_number_fixation, digits = 0),
    Number_fixation_msec_mtu = round(Sum_number_fixation / Duration_of_interval, digits = 6),
    Number_fixation_sec_mtu = round(Sum_number_fixation / Duration_of_interval_sec, digits = 2),
    Number_fixation_min_mtu = round(Sum_number_fixation / Duration_of_interval_min, digits = 0),
    Group = as_factor(Group)
  ) %>%
  drop_na() -> df_aoi_sum


# N, M, SD, min & max number of fixation per minute (micro-teaching unit)
nof.table <-
  df_aoi_sum %>%
  group_by(Group) %>%
  summarise(
    N = n(),
    "M" = round(mean(Number_fixation_min_mtu), digits = 2),
    "SD" = round(sd(Number_fixation_min_mtu), digits = 2),
    "Min" = round(min(Number_fixation_min_mtu), digits = 2),
    "Max" = round(max(Number_fixation_min_mtu), digits = 2)
  )

knitr::kable(nof.table,
             caption = "N, M, SD, min & max number of fixation per minute (micro-teaching unit)")


# plotting number of fixations (micro-teaching unit)
df_aoi_sum %>%
  ggplot(mapping = aes(x = Group, y = Number_fixation_min_mtu)) +
  geom_boxplot(mapping = aes(fill = Group), outlier.shape = NA) +
  geom_point(
    size = 2,
    alpha = 0.7,
    position = position_jitter(
      seed = 1,
      width = 0.1,
      height = 0.1
    )
  ) +
  ylim(0, 150) +
  labs(x = "", y = "Number of fixations per minute") +
  scale_fill_brewer(palette  = "RdBu") +
  ggtitle("Number of fixations per minute\n(micro-teaching unit)") +
  theme_cowplot() +
  theme(legend.position = "none") -> plot_number_group

plot_number_group

```

#### t-test & effect size "Number of fixation (micro-teaching unit)"
```{r nof_all_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# NUMBER OF FIXATIONS PER MINUTE (micro-teaching unit) 
# t-test for expertise differences
t.test(
  x = df_aoi_sum$Number_fixation_min_mtu[df_aoi_sum$Group == "Expert"],
  y = df_aoi_sum$Number_fixation_min_mtu[df_aoi_sum$Group == "Novice"],
  var.equal = TRUE
)

# NUMBER OF FIXATIONS PER MINUTE (micro-teaching unit)
# effect size for expertise differences
d_number_all <- CohenD(
  x = df_aoi_sum$Number_fixation_min_mtu[df_aoi_sum$Group == "Expert"],
  y = df_aoi_sum$Number_fixation_min_mtu[df_aoi_sum$Group == "Novice"],
  na.rm = TRUE
)

round(d_number_all, 2)

```

#### 2.2.2 Number of fixations per minute (AOI students)
```{r nof_students, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

##################### NUMBER OF FIXATIONS (AOI STUDENTS) ########################

# filter group & total duration & number fixation (AOI students)
df_aoi %>%
  filter(TOI == "Lesson") %>%
  dplyr::select (
    Group,
    Duration_of_interval,
    Participant,
    "Total_duration_of_fixations.Anna",
    "Total_duration_of_fixations.Bianca",
    "Total_duration_of_fixations.Carl(a)",
    "Number_of_fixations.Anna",
    "Number_of_fixations.Bianca",
    "Number_of_fixations.Carl(a)"
  ) %>%
  rowwise() %>%
  transmute(
    Group = as_factor(Group),
    Duration_of_interval_min = round(Duration_of_interval/60000, digits = 2),
    Duration_of_interval_sec = round(Duration_of_interval/1000, digits = 2),
    Participant = Participant,
    Stud_duration_fixation = sum(c_across(starts_with("Total_duration")), na.rm = TRUE),
    Stud_number_fixation = sum(c_across(starts_with("Number_of")), na.rm = TRUE),
    Stud_number_fixation_min = round(Stud_number_fixation / Duration_of_interval_min, digits = 2),
    Stud_number_fixation_sec = round(Stud_number_fixation / Duration_of_interval_sec, digits = 2),
    Average_duration_stud = round(Stud_duration_fixation / Stud_number_fixation, digits = 0)
    ) -> df_aoi_stud

# N, M, SD, min & max number of fixations per minute (AOI students)
nof.min.stud.table <-
  df_aoi_stud %>%
  group_by(Group) %>%
  summarise(
    N = n(),
    "M" = round(mean(Stud_number_fixation_min), digits = 2),
    "SD" = round(sd(Stud_number_fixation_min), digits = 2),
    "Min" = round(min(Stud_number_fixation_min), digits = 2),
    "Max" = round(max(Stud_number_fixation_min), digits = 2)
  )

knitr::kable(nof.min.stud.table,
             caption = "N, M, SD, min & max number of fixations per minute (AOI students)")


# plotting number of fixations per minute on AOI Students
df_aoi_stud %>%
  ggplot(mapping = aes(x = Group, y = Stud_number_fixation_min)) +
  geom_boxplot(mapping = aes(fill = Group), outlier.shape = NA) +
  geom_point(
    size = 2,
    alpha = 0.7,
    position = position_jitter(
      seed = 1,
      width = 0.1,
      height = 0.005
    )
  ) +
  ylim(0, 50) +
  labs(x = "", y = "Number of fixations per minute") +
  scale_fill_brewer(palette  = "RdBu") +
  ggtitle("Number of fixations per minute\n(AOI students)") +
  theme_cowplot() +
  theme(legend.position = "none") -> plot_number_min_stud

plot_number_min_stud

```

#### t-test & effect size "Number of fixation" (AOI students)
```{r nof_stud_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# NUMBER OF FIXATIONS on AOI students 
# t-test for expertise differences
t.test(
  x = df_aoi_stud$Stud_number_fixation_min[df_aoi_stud$Group == "Expert"],
  y = df_aoi_stud$Stud_number_fixation_min[df_aoi_stud$Group == "Novice"],
  var.equal = TRUE
)


# NUMBER OF FIXATIONS on AOI students
# effect size for expertise differences
d_number_stud <- CohenD(
  x = df_aoi_stud$Stud_number_fixation_min[df_aoi_stud$Group == "Expert"],
  y = df_aoi_stud$Stud_number_fixation_min[df_aoi_stud$Group == "Novice"],
  na.rm = TRUE
)

round(d_number_stud, 2)

```

#### 2.2.3 Number of fixations (AOI disruptive person)
```{r nof_disrup, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

##################### NUMBER OF FIXATION ON AOI DISRUPTIVE PERSON ########################

# filter group & total duration & number fixation on AOI "disruptive person"
df_aoi %>%
  filter(TOI == "Lesson") %>%
  dplyr::select(Group, 
                Participant, 
                "Number_of_fixations.Disruptive_Person") %>%
  mutate(Group = as_factor(Group)) -> df_aoi_disrup


# N, M, SD, min & max number of fixation on AOI "disruptive person"
nof.disrup.table <-
  df_aoi_disrup %>%
  group_by(Group) %>%
  summarise(
    N = n(),
    "M" = round(mean(Number_of_fixations.Disruptive_Person), digits = 2),
    "SD" = round(sd(Number_of_fixations.Disruptive_Person), digits = 2),
    "Min" = round(min(Number_of_fixations.Disruptive_Person), digits = 2),
    "Max" = round(max(Number_of_fixations.Disruptive_Person), digits = 2)
  )

knitr::kable(nof.disrup.table,
             caption = "N, M, SD, min & max number of fixation (AOI disruptive person)")


# plotting average duration on AOI Disruptive person
df_aoi_disrup %>%
  ggplot(mapping = aes(x = Group, y = Number_of_fixations.Disruptive_Person)) +
  geom_boxplot(mapping = aes(fill = Group), outlier.shape = NA) +
  geom_point(
    size = 2,
    alpha = 0.7,
    position = position_jitter(
      seed = 1,
      width = 0.1,
      height = 0.1
    )
  ) +
  ylim(0, 150) +
  labs(x = "", y = "Number of fixations") +
  scale_fill_brewer(palette  = "RdBu") +
  ggtitle("Number of fixations\n(AOI disruptive person)") +
  theme_cowplot() +
  theme(legend.position = "none") -> plot_number_disrup

plot_number_disrup
```

#### t-test & effect size "Number of fixations" (AOI disruptive person)
```{r nof_disrup_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# NUMBER OF FIXATIONS on AOI disruptive person 
# t-test for expertise differences
t.test(x = df_aoi_disrup$Number_of_fixations.Disruptive_Person[df_aoi_disrup$Group == "Expert"],
       y = df_aoi_disrup$Number_of_fixations.Disruptive_Person[df_aoi_disrup$Group == "Novice"],
       var.equal = TRUE)

# NUMBER OF FIXATIONS 
# effect size for expertise differences
d_number_disrup <- CohenD(x = df_aoi_disrup$Number_of_fixations.Disruptive_Person[df_aoi_disrup$Group == "Expert"],
                        y = df_aoi_disrup$Number_of_fixations.Disruptive_Person[df_aoi_disrup$Group == "Novice"],
                        na.rm = TRUE)

round(d_number_disrup, 2)

```

#### 2.2.4 Average duration of fixations in milliseconds (micro-teaching unit)
```{r dur_all, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

##################### AVERAGE DURATION OF FIXATIONS (MICRO-TEACHING UNIT) ########################

# N, M, SD, min & max average duration of fixations (micro-teaching unit)
dur.table <- 
  df_aoi_sum %>%  
  group_by(Group) %>% 
  summarise(
    N = n(),
    "M in ms" = round(mean(Average_duration_mtu), digits = 2),
    "SD in ms" = round(sd(Average_duration_mtu), digits = 2),
    "Min in ms" = round(min(Average_duration_mtu), digits = 2),
    "Max in ms" = round(max(Average_duration_mtu), digits = 2)
    )

knitr::kable(dur.table,
             caption = "N, M, SD, min & max duration of fixations in milliseconds (micro-teaching unit)")


# plotting average duration (micro-teaching unit)
df_aoi_sum %>% 
  ggplot(mapping = aes(x = Group,
                       y = Average_duration_mtu)) +
  geom_boxplot(mapping = aes(fill = Group),
               outlier.shape = NA) +
  geom_point(size = 2,
             alpha = 0.7,
             position = position_jitter(seed = 1,
                                        width = 0.1,
                                        height = 0.1)) +
  ylim(0, 1000) +
  
  labs(x ="",
       y = "Milliseconds") + 
  scale_fill_brewer(palette  = "RdBu") + 
  ggtitle("Average duration of fixations\n(micro-teaching unit)") +
  theme_cowplot() +
  theme(legend.position="none") -> plot_average_duration_group

plot_average_duration_group

```

#### t-test & effect size "Average duration of fixations" (micro-teaching unit)
```{r dur_all_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# AVERAGE DURATION OF FIXATIONS on all AOIs 
# t-test for expertise differences
t.test(x = df_aoi_sum$Average_duration_mtu[df_aoi_sum$Group == "Expert"],
       y = df_aoi_sum$Average_duration_mtu[df_aoi_sum$Group == "Novice"],
       var.equal = TRUE)

# AVERAGE DURATION OF FIXATIONS on all AOIs
# effect size for expertise differences
d_aver_all <- CohenD(x = df_aoi_sum$Average_duration_mtu[df_aoi_sum$Group == "Expert"],
                     y = df_aoi_sum$Average_duration_mtu[df_aoi_sum$Group == "Novice"],
                    na.rm = TRUE)
round(d_aver_all, 2)

```

#### 2.2.5 Average duration of fixations (AOI students)
```{r dur_students, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

##################### AVERAGE DURATION ON AOI STUDENTS ########################

# filter group & total duration & number fixation on AOI Students
df_aoi %>%
  filter(TOI == "Lesson") %>%
  dplyr::select (
    Group,
    "Total_duration_of_fixations.Anna",
    "Total_duration_of_fixations.Bianca",
    "Total_duration_of_fixations.Carl(a)",
    "Number_of_fixations.Anna",
    "Number_of_fixations.Bianca",
    "Number_of_fixations.Carl(a)"
  ) %>%
  rowwise() %>%
  transmute(
    Group = Group,
    Stud_duration_fixation = sum(c_across(starts_with("Total_duration")), na.rm = TRUE),
    Stud_number_fixation = sum(c_across(starts_with("Number_of")), na.rm = TRUE)
  ) %>%
  mutate(
    Average_duration_stud = round(Stud_duration_fixation / Stud_number_fixation, digits = 0),
    Group = as_factor(Group)
  ) -> df_aoi_stud


# N, M, SD, min & max average duration of fixations on AOI students
dur.stud.table <-
  df_aoi_stud %>%
  group_by(Group) %>%
  summarise(
    N = n(),
    "M in ms" = round(mean(Average_duration_stud), digits = 2),
    "SD in ms" = round(sd(Average_duration_stud), digits = 2),
    "Min in ms" = round(min(Average_duration_stud), digits = 2),
    "Max in ms" = round(max(Average_duration_stud), digits = 2)
  )

knitr::kable(dur.stud.table,
             caption = "N, M, SD, min & max average duration of fixations in milliseconds (AOI students)")


# plotting average duration on AOI Students
df_aoi_stud %>%
  ggplot(mapping = aes(x = Group, y = Average_duration_stud)) +
  geom_boxplot(mapping = aes(fill = Group), outlier.shape = NA) +
  geom_point(
    size = 2,
    alpha = 0.7,
    position = position_jitter(
      seed = 1,
      width = 0.1,
      height = 0.1
    )
  ) +
  ylim(0, 1200) + 
  labs(x ="",
       y = "Milliseconds") + 
  scale_fill_brewer(palette  = "RdBu") + 
  ggtitle("Average duration of fixations\n(AOI students)") +
  theme_cowplot() +
  theme(legend.position="none") -> plot_average_duration_stud

plot_average_duration_stud

```

#### t-test & effect size "Average duration of fixations" (AOI students)
```{r dur_stud_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# AVERAGE DURATION OF FIXATIONS on AOI Students 
# t-test for expertise differences
t.test(
  x = df_aoi_stud$Average_duration_stud[df_aoi_stud$Group == "Expert"],
  y = df_aoi_stud$Average_duration_stud[df_aoi_stud$Group == "Novice"],
  var.equal = TRUE
)

# AVERAGE DURATION OF FIXATIONS on AOI Students
# effect size for expertise differences
d_aver_stud <- CohenD(
  x = df_aoi_stud$Average_duration_stud[df_aoi_stud$Group == "Expert"],
  y = df_aoi_stud$Average_duration_stud[df_aoi_stud$Group == "Novice"],
  na.rm = TRUE
)

round(d_aver_stud, 2)

```

#### 2.2.6 Average duration of fixations (AOI disruptive person)
```{r dur_disrup, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

##################### AVERAGE DURATIONS ON AOI DISRUPTIVE PERSON ########################

# filter group & total duration & number fixation on AOI Disruptive person
df_aoi %>%
  filter(TOI == "Lesson") %>%
  dplyr::select (
    Group,
    "Total_duration_of_fixations.Disruptive_Person",
    "Number_of_fixations.Disruptive_Person"
  ) %>%
  rowwise() %>%
  mutate(
    Average_duration_disrup = round(
      Total_duration_of_fixations.Disruptive_Person / Number_of_fixations.Disruptive_Person,
      digits = 0
    ),
    Group = as_factor(Group)
  ) -> df_aoi_disrup

# N, M, SD, min & max average duration of fixations in milliseconds (AOI disruptive person)"
dur.disrup.table <-
  df_aoi_disrup %>%
  group_by(Group) %>%
  summarise(
    N = n(),
    "M in ms" = round(mean(Average_duration_disrup), digits = 2),
    "SD in ms" = round(sd(Average_duration_disrup), digits = 2),
    "Min in ms" = round(min(Average_duration_disrup), digits = 2),
    "Max in ms" = round(max(Average_duration_disrup), digits = 2)
  )

knitr::kable(dur.disrup.table,
             caption = "N, M, SD, min & max average duration of fixations in milliseconds (AOI disruptive person)")

# plotting average duration on AOI Disruptive person
df_aoi_disrup %>% 
  ggplot(mapping = aes(x = Group,
                       y = Average_duration_disrup)) +
  geom_boxplot(mapping = aes(fill = Group),
               outlier.shape = NA) +
  geom_point(size = 2,
             alpha = 0.7,
             position = position_jitter(seed = 1,
                                        width = 0.1,
                                        height = 0.1)) +
  ylim(0, 1500) +
  labs(x ="",
       y = "Milliseconds") + 
  scale_fill_brewer(palette  = "RdBu") + 
  ggtitle("Average duration of fixations\n(AOI disruptive person)") +
  theme_cowplot() +
  theme(legend.position="none") -> plot_average_duration_disrup

plot_average_duration_disrup

```

#### t-test & effect size "Average duration of fixations" (AOI disruptive person)
```{r _disrup_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# AVERAGDE DURATION OF FIXATIONS on AOI disruptive person 
# t-test for expertise differences
t.test(x = df_aoi_disrup$Average_duration_disrup[df_aoi_disrup$Group == "Expert"],
       y = df_aoi_disrup$Average_duration_disrup[df_aoi_disrup$Group == "Novice"],
       var.equal = TRUE)

# NUMBER OF FIXATIONS 
# effect size for expertise differences
d_dur_disrup <- CohenD(x = df_aoi_disrup$Average_duration_disrup[df_aoi_disrup$Group == "Expert"],
                        y = df_aoi_disrup$Average_duration_disrup[df_aoi_disrup$Group == "Novice"],
                        na.rm = TRUE)

round(d_dur_disrup, 2)

```

#### 2.2.7 Gaze Relational Index (GRI; micro-teaching unit)
```{r gri_all, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

##################### GRI IN MICRO-TEACHING UNIT ########################

# filter group, participants, total duration & number fixation in entire micro-teaching unit
df_aoi_sum %>%
  group_by(Group) %>% 
  mutate(
    GRI = round(Average_duration_mtu / Number_fixation_min_mtu, digits = 2),
    )-> df_gri


# N, M, SD, min & max number of fixation (micro-teaching unit)
gri.table <-
  df_gri %>%
  group_by(Group) %>%
  summarise(
    N = n(),
    "M" = round(mean(GRI), digits = 2),
    "SD" = round(sd(GRI), digits = 2),
    "Min" = round(min(GRI), digits = 2),
    "Max" = round(max(GRI), digits = 2)
  )

knitr::kable(gri.table,
             caption = "N, M, SD, min & max GRI (micro-teaching unit)")


# plotting number of fixations on ALL AOIS
df_gri %>%
  ggplot(mapping = aes(x = Group, y = GRI)) +
  geom_boxplot(mapping = aes(fill = Group), outlier.shape = NA) +
  geom_point(
    size = 2,
    alpha = 0.7,
    position = position_jitter(
      seed = 1,
      width = 0.1,
      height = 0.1
    )
  ) +
  ylim(0, 12) +
  labs(x = "", y = "average duration of fixations/\nnumber of fixations per minute") +
  scale_fill_brewer(palette  = "RdBu") +
  ggtitle("GRI\n(micro-teaching unit)") +
  theme_cowplot() +
  theme(legend.position = "none") -> plot_gri_group

plot_gri_group

```

#### t-test & effect size "GRI" (micro-teaching unit)
```{r gri_all_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# GRI (mirco-teaching unit)
# t-test for expertise differences
t.test(x = df_gri$GRI[df_gri$Group == "Expert"],
       y = df_gri$GRI[df_gri$Group == "Novice"],
       var.equal = TRUE)

# GRI (mirco-teaching unit) 
# effect size for expertise differences
d_gri_all <- CohenD(x = df_gri$GRI[df_gri$Group == "Expert"],
                        y = df_gri$GRI[df_gri$Group == "Novice"],
                        na.rm = TRUE)

round(d_gri_all, 2)

```

```{r gri_stud, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# ##################### GRI on AOI students ########################
# 
# # filter group, participants, total duration & number fixation on AOI students
# df_aoi_stud %>%
#   group_by(Group) %>% 
#   mutate(
#     GRI_stud = round(Average_duration_stud / Stud_number_fixation, digits = 2),
#     )-> df_gri_stud
# 
# 
# # N, M, SD, min & max GRI (AOI students)
# gri.stud.table <-
#   df_gri_stud %>%
#   group_by(Group) %>%
#   summarise(
#     N = n(),
#     "M" = round(mean(GRI_stud), digits = 2),
#     "SD" = round(sd(GRI_stud), digits = 2),
#     "Min" = round(min(GRI_stud), digits = 2),
#     "Max" = round(max(GRI_stud), digits = 2)
#   )
# 
# knitr::kable(gri.stud.table,
#              caption = "N, M, SD, min & max GRI (AOI students)")
# 
# 
# # plotting GRI on AOI students
# df_gri_stud %>%
#   ggplot(mapping = aes(x = Group, y = GRI_stud)) +
#   geom_boxplot(mapping = aes(fill = Group), outlier.shape = NA) +
#   geom_point(
#     size = 2,
#     alpha = 0.7,
#     position = position_jitter(
#       seed = 1,
#       width = 0.1,
#       height = 0.1
#     )
#   ) +
#   ylim(0, 2.5) +
#   labs(x = "", y = "mean duration of fixations/\nmean number of fixations") +
#   scale_fill_brewer(palette  = "RdBu") +
#   ggtitle("GRI\n(AOI students)") +
#   theme_cowplot() +
#   theme(legend.position = "none") -> plot_gri_stud
# 
# plot_gri_stud

```

```{r gri_stud_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# # GRI (AOI students)
# # t-test for expertise differences
# t.test(x = df_gri_stud$GRI_stud[df_gri_stud$Group == "Expert"],
#        y = df_gri_stud$GRI_stud[df_gri_stud$Group == "Novice"],
#        var.equal = TRUE)
# 
# # GRI (AOI students) 
# # effect size for expertise differences
# d_gri_stud <- CohenD(x = df_gri_stud$GRI_stud[df_gri_stud$Group == "Expert"],
#                      y = df_gri_stud$GRI_stud[df_gri_stud$Group == "Novice"],
#                      na.rm = TRUE)
# 
# round(d_gri_stud, 2)

```

```{r gri_disrup, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# ##################### GRI on AOI students ########################
# 
# # filter
# df_aoi_disrup %>%
#   group_by(Group) %>% 
#   mutate(
#     GRI_disrup = round(Average_duration_disrup / Number_of_fixations.Disruptive_Person, digits = 2),
#     )-> df_gri_disrup
# 
# 
# # N, M, SD, min & max GRI (AOI disruptive person)
# gri.disrup.table <-
#   df_gri_disrup %>%
#   group_by(Group) %>%
#   summarise(
#     N = n(),
#     "M" = round(mean(GRI_disrup), digits = 2),
#     "SD" = round(sd(GRI_disrup), digits = 2),
#     "Min" = round(min(GRI_disrup), digits = 2),
#     "Max" = round(max(GRI_disrup), digits = 2)
#   )
# 
# knitr::kable(gri.disrup.table,
#              caption = "N, M, SD, min & max GRI (AOI disruptive person)")
# 
# 
# # plotting GRI on AOI disruptive person
# df_gri_disrup %>%
#   ggplot(mapping = aes(x = Group, y = GRI_disrup)) +
#   geom_boxplot(mapping = aes(fill = Group), outlier.shape = NA) +
#   geom_point(
#     size = 2,
#     alpha = 0.7,
#     position = position_jitter(
#       seed = 1,
#       width = 0.1,
#       height = 0.1
#     )
#   ) +
#   ylim(0, 25) +
#   labs(x = "", y = "mean duration of fixations/\nmean number of fixations") +
#   scale_fill_brewer(palette  = "RdBu") +
#   ggtitle("GRI\n(AOI disruptive person)") +
#   theme_cowplot() +
#   theme(legend.position = "none") -> plot_gri_disrup
# 
# plot_gri_disrup

```

```{r gri_disrup_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# # GRI (AOI disruptive person)
# # t-test for expertise differences
# t.test(x = df_gri_disrup$GRI_disrup[df_gri_disrup$Group == "Expert"],
#        y = df_gri_disrup$GRI_disrup[df_gri_disrup$Group == "Novice"],
#        var.equal = TRUE)
# 
# # GRI (AOI disruptive person)
# # effect size for expertise differences
# d_gri_disrup <- CohenD(x = df_gri_disrup$GRI_disrup[df_gri_disrup$Group == "Expert"],
#                        y = df_gri_disrup$GRI_disrup[df_gri_disrup$Group == "Novice"],
#                        na.rm = TRUE)
# 
# round(d_gri_disrup, 2)

```

#### 2.2.10 Time to first fixation in seconds (AOI disruptive person)
```{r ttff_disrup, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

############### TIME TO FIRST FIXATION ####################


df_aoi %>% 
  filter(TOI %in% c("Chatting_with_neighbour",
                    "Clicking_pen",
                    "Drawing",
                    "Drumming_with_hands",
                    "Head_on_table",
                    "Heckling",
                    "Looking_at_phone",
                    "Snipping_with_fingers",
                    "Whispering"
                    )
         ) %>% 
  dplyr::select(Participant,
                TOI,
                Time_to_first_fixation.Disruptive_Person,
                ) %>% 
  rowwise() %>% 
  drop_na() %>% 
  group_by(Participant) %>% 
  filter(!Time_to_first_fixation.Disruptive_Person == 0, # exclude all participants with 0 msec
         !Time_to_first_fixation.Disruptive_Person > 30000) %>% # cut-off 30sec
  summarise(N = n(),
            Time_to_first_fixation.Disruptive_Person_Sum = sum(Time_to_first_fixation.Disruptive_Person/N)
            ) %>% 
  mutate(Group = ifelse(Participant < 200, "Novice", "Expert"),
         Sum_disruptions = sum(N),
         Disrup_time_fixation_sec = round(Time_to_first_fixation.Disruptive_Person_Sum / 1000, 
                                          digits = 2)) -> df_ttff_disrup # changing milliseconds into seconds 


############### M, SD, min, max time to first fixation "Disruptive Person"
ttff.disrup.table <-
  df_ttff_disrup %>%
  filter(!Participant %in% c("216", "113", "123")) %>% 
  group_by(Group) %>%
  summarise(
    N = n(),
    "M in sec" = round(mean(Disrup_time_fixation_sec), digits = 2),
    "SD in sec" = round(sd(Disrup_time_fixation_sec), digits = 2),
    "Min in sec" = round(min(Disrup_time_fixation_sec), digits = 2),
    "Max in sec" = round(max(Disrup_time_fixation_sec), digits = 2)
  )

knitr::kable(ttff.disrup.table,
             caption = "N, M, SD, min & max time to first fixation in seconds (AOI disruptive person)")


############### M, SD, min, max of the perceived "Disruptive Person" ############### 
number.perceived.disrup.table <-
 df_ttff_disrup %>%
  filter(!Participant %in% c("216", "113", "123")) %>%
  group_by(Group) %>%
  summarise(
    Mean = round(mean(N, na.rm = TRUE), digits = 2),
    SD = round(sd(N, na.rm = TRUE), digits = 2), 
    Min = min(N, na.rm = TRUE),
    Max = max(N, na.rm = TRUE)
  )

knitr::kable(number.perceived.disrup.table,
             caption = "N, M, SD, min & max of the perceived ´disruptive person´")


############### PLOTTING ############### 

##################### plotting "perceived disruptive person" for groups ##################### 
plot_n_disrup <- 
  df_ttff_disrup %>%
  filter(!Participant %in% c("216", "113", "123")) %>%
  ggplot(mapping = aes(x = Group,
                       y = N)) +
 geom_boxplot(mapping = aes(fill = Group),
               outlier.shape = NA) +
  geom_point(size = 2,
             alpha = 0.7,
             position = position_jitter(seed = 1,
                                        width = 0.1,
                                        height = 0.1)) +
  ylim(0,10) +
  labs(x ="",
       y = "Counts") + 
  scale_fill_brewer(palette  = "RdBu") +
  ggtitle("Counts of the perceived ´disruptive person´\n") +
  theme_cowplot() +
  theme(legend.position="none") 

plot_n_disrup


##################### plotting time to first fixation for groups ##################### 
plot_time_disrup <- 
  df_ttff_disrup %>%
  filter(!Participant %in% c("216", "113", "123")) %>%
  ggplot(mapping = aes(x = Group,
                       y = Disrup_time_fixation_sec)) +
 geom_boxplot(mapping = aes(fill = Group),
               outlier.shape = NA) +
  geom_point(size = 2,
             alpha = 0.7,
             position = position_jitter(seed = 1,
                                        width = 0.1,
                                        height = 0.1)) +
  ylim(0,10) +
  labs(x ="",
       y = "Seconds") + 
  scale_fill_brewer(palette  = "RdBu") +
  ggtitle("Time to first fixation\n(AOI disruptive person)") +
  theme_cowplot() +
  theme(legend.position="none") 

plot_time_disrup

```

#### t-test & effect size "Time to first fixation" (AOI disruptive person)
```{r ttff_disrup_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# TIME TO FIRST FIXATIONS on disruptive person 
# t-test for expertise differences
t.test(x = df_ttff_disrup$Disrup_time_fixation_sec[df_ttff_disrup$Group == "Expert"],
       y = df_ttff_disrup$Disrup_time_fixation_sec[df_ttff_disrup$Group == "Novice"],
       var.equal = TRUE)

# TIME TO FIRST FIXATIONS on disruptive person 
# effect size for expertise differences
d_time_disrup <- CohenD(x = df_ttff_disrup$Disrup_time_fixation_sec[df_ttff_disrup$Group == "Expert"],
                    y = df_ttff_disrup$Disrup_time_fixation_sec[df_ttff_disrup$Group == "Novice"],
                    na.rm = TRUE)

round(d_time_disrup, 2)

```

### 2.2 Rating Scales (Disruption Appraisal, Confidence Appraisal, Prevalence Rating)
```{r rating_scales, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# read in data and combine multiple excel sheets into a single table 
sri <-
  excel_sheets("data/Coding_SRI.xlsx") %>%
  map_df(~ read_xlsx("data/Coding_SRI.xlsx", .)) %>%
  filter(
    !ID %in% c(201),
    !disruption_appraisal == -100,
    !confidence_appraisal == -100,
    !disruption_appraisal == -99,
    !confidence_appraisal == -99,
    !disruption_appraisal == -88,
    !confidence_appraisal == -88,
    !prevalence_rating == -100,
    !prevalence_rating == -99,
    !prevalence_rating == -88
    ) %>%
  mutate(ID = ifelse(ID < 200, "Novice", "Expert"))

############## Disruption appraisal #########################

sri.disrup.table <-
  sri %>%
  group_by(ID) %>%
  summarise(
    N = n(),
    "M" = round(mean(disruption_appraisal), digits = 2),
    "SD" = round(sd(disruption_appraisal), digits = 2),
    "Min" = min(disruption_appraisal),
    "Max" = max(disruption_appraisal)
    )

knitr::kable(sri.disrup.table,
             caption = "Disruption Appraisal")

### with event
sri.disrup.event.table <-
  sri %>%
  group_by(ID, event) %>%
  summarise(
    N = n(),
    "M" = round(mean(disruption_appraisal), digits = 2),
    "SD" = round(sd(disruption_appraisal), digits = 2),
    "Min" = min(disruption_appraisal),
    "Max" = max(disruption_appraisal)
  )

# insert a table into HTML
knitr::kable(sri.disrup.event.table,
             caption = "Disruption appraisal with event")

# create a new data frame with appraisal
sri_disrup <- subset.data.frame(sri, select = c(ID, event, disruption_appraisal))

# plotting disruption appraisal for groups
dist_group_plot <- 
  sri_disrup %>% 
  mutate(ID = factor(ID,
                     levels = c("Novice",
                                "Expert"
                                )
                     )
         ) %>% 
  ggplot(mapping = aes(x = ID,
                       y = disruption_appraisal)) +
  geom_boxplot(mapping = aes(fill = ID),
               outlier.shape = NA) +
  geom_point(size = 1,
             alpha = 0.4,
             position = position_jitter(seed = 1,
                                        width = 0.1,
                                        height = 0.1)) +
  scale_x_discrete(limits = c("Novice", "Expert")) +
  scale_y_continuous(breaks = seq(from = 0, to = 10, by = 1)) + 
  labs(x = "",
       y = "Disruption Appraisal") + 
  scale_fill_brewer(palette  = "RdBu") +  
  ggtitle("How disruptive was the event for you?") +
  theme_cowplot()

dist_group_plot
```

#### t-Test & effect size "Disruption appraisal"
```{r sri_da_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

#################### T-TEST & EFFECT SIZE ############

# Disruption appraisal 
# t-test for expertise differences
t.test(x = sri$disruption_appraisal[sri$ID == "Expert"],
       y = sri$disruption_appraisal[sri$ID == "Novice"],
       var.equal = TRUE)

# Disruption appraisal 
# effect size for expertise differences
d_sri_disrup <- CohenD(x = sri$disruption_appraisal[sri$ID == "Expert"],
                       y = sri$disruption_appraisal[sri$ID == "Novice"],
                       na.rm = TRUE)

round(d_sri_disrup, 2)
```

```{r sri_ca, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

############## Confidence appraisal #########################

sri.confi.table <-
  sri %>%
  group_by(ID) %>%
  summarise(
    "M" = round(mean(confidence_appraisal), digits = 2),
    "SD" = round(sd(confidence_appraisal), digits = 2),
    "Min" = min(confidence_appraisal),
    "Max" = max(confidence_appraisal)
  )

# insert a table into HTML
knitr::kable(sri.confi.table,
             caption = "Confidence appraisal")

### with event
sri.confi.event.table <- 
  sri %>%
  group_by(ID, event) %>%
  summarise(
    N = n(),
    "M" = round(mean(confidence_appraisal), digits = 2),
    "SD" = round(sd(confidence_appraisal), digits = 2),
    "Min" = min(confidence_appraisal),
    "Max" = max(confidence_appraisal)
  )

knitr::kable(sri.confi.event.table,
             caption = "Confidence appraisal with event")

# create a new data frame with appraisal
sri_confi <- subset.data.frame(sri, 
                               select = c(ID, 
                                          event, 
                                          confidence_appraisal)
                               )

# plotting confidence appraisal for groups
confi_group_plot <- 
  sri_confi %>% 
  mutate(ID = factor(ID,
                     levels = c("Novice",
                                "Expert"
                                )
                     )
         ) %>% 
  ggplot(mapping = aes(x = ID,
                       y = confidence_appraisal)) +
  geom_boxplot(mapping = aes(fill = ID),
               outlier.shape = NA) +
  geom_point(size = 1,
             alpha = 0.4,
             position = position_jitter(seed = 1,
                                        width = 0.1,
                                        height = 0.1)) +
  scale_x_discrete(limits = c("Novice", "Expert")) +
  scale_y_continuous(breaks = seq(from = 0, to = 10, by = 1)) + 
  labs(x = "",
       y = "Confidence Appraisal") + 
  scale_fill_brewer(palette  = "RdBu") +  
  ggtitle("How confident did you feel dealing with this event?") +
  theme_cowplot()

confi_group_plot
```

#### t-Test & effect size "Confidence appraisal"
```{r sri_ca_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

#################### T-TEST & EFFECT SIZE ############

# Confidence Appraisal 
# t-test for expertise differences
t.test(x = sri$confidence_appraisal[sri$ID == "Expert"],
       y = sri$confidence_appraisal[sri$ID == "Novice"],
       var.equal = TRUE)

# Disruption Factor 
# effect size for expertise differences
d_sri_confi <- CohenD(x = sri$confidence_appraisal[sri$ID == "Expert"],
                      y = sri$confidence_appraisal[sri$ID == "Novice"],
                      na.rm = TRUE)

round(d_sri_confi, 2)
```

### Prevalence Rating as Manipulation check 
```{r sri_pr, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

############## Prevalence Rating #########################

sri.preva.table <-
  sri %>%
  group_by(ID) %>%
  summarise(
    N = n(),
    "M" = round(mean(prevalence_rating), digits = 2),
    "SD" = round(sd(prevalence_rating), digits = 2),
    "Min" = min(prevalence_rating),
    "Max" = max(prevalence_rating)
  )

# insert a table into HTML
knitr::kable(sri.preva.table,
             caption = "Prevalence rating")

#### with event 
sri.preva.event.table <-
  sri %>%
  group_by(ID, event) %>%
  summarise(
    N = n(),
    "M" = round(mean(prevalence_rating), digits = 2),
    "SD" = round(sd(prevalence_rating), digits = 2),
    "Min" = min(prevalence_rating),
    "Max" = max(prevalence_rating)
  )

# insert a table into HTML
knitr::kable(sri.preva.event.table,
             caption = "Prevalence rating with events")

# create a new data frame with rating
sri_preva <- subset.data.frame(sri, select = c(ID, event, prevalence_rating))

# plotting prevalence rating for groups
preva_group_plot <- 
  sri_preva %>% 
  mutate(ID = factor(ID,
                     levels = c("Novice",
                                "Expert"
                                )
                     )
         ) %>% 
  ggplot(mapping = aes(x = ID,
                       y = prevalence_rating)) +
  geom_boxplot(mapping = aes(fill = ID),
               outlier.shape = NA) +
  geom_point(size = 1,
             alpha = 0.4,
             position = position_jitter(seed = 1,
                                        width = 0.1,
                                        height = 0.1)) +
  scale_x_discrete(limits = c("Novice", "Expert")) +
  scale_y_continuous(breaks = seq(from = 0, to = 10, by = 1)) + 
  labs(x = "",
       y = "Prevalence Rating") + 
  scale_fill_brewer(palette  = "RdBu") +  
  ggtitle("How widespread is this event in the classroom?") +
  theme_cowplot()

preva_group_plot

```

#### t-Test & effect size "Prevalence rating"
```{r sri_pr_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

#################### T-TEST & EFFECT SIZE ############

# Prevalence Rating 
# t-test for expertise differences
t.test(x = sri$prevalence_rating[sri$ID == "Expert"],
       y = sri$prevalence_rating[sri$ID == "Novice"],
       var.equal = TRUE)

# Prevalence Rating 
# effect size for expertise differences
d_sri_preva <- CohenD(x = sri$prevalence_rating[sri$ID == "Expert"],
                      y = sri$prevalence_rating[sri$ID == "Novice"],
                      na.rm = TRUE)

round(d_sri_preva, 2)

```

### Internal consistency (Omega) for disruption and confidence appraisal
```{r sri_omega, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# Select the relevant columns (e.g., Disruption Appraisal and Confidence Appraisal)
sri <-
  excel_sheets("data/Coding_SRI.xlsx") %>%
  map_df(~ read_xlsx("data/Coding_SRI.xlsx", .)) %>%
  filter(
    !ID %in% c(201, 223),
    !disruption_appraisal == -100,
    !confidence_appraisal == -100,
    !disruption_appraisal == -99,
    !confidence_appraisal == -99,
    !disruption_appraisal == -88,
    !confidence_appraisal == -88,
    !prevalence_rating == -100,
    !prevalence_rating == -99,
    !prevalence_rating == -88
    ) 

# change long to wide format
sri_wide <- sri %>%
  pivot_wider(names_from = event, 
              values_from = c(disruption_appraisal, confidence_appraisal, prevalence_rating))


### DISRUPTIONS APPRAISAL 

# create new data frame with only disruption items
sri_wide_disrup <- sri_wide %>%
  dplyr::select(starts_with("disruption_appraisal")) %>% 
  drop_na()

# calculate omega with omega() function  
omega_disrup <- omega(sri_wide_disrup)

# display the results 
print(omega_disrup)
 

### CONFIDENCE APPRAISAL 
 
# create new data frame with only confidence items
sri_wide_confi <- sri_wide %>%
  dplyr::select(starts_with("confidence_appraisal")) %>% 
  drop_na()

# calculate omega with omega() function  
omega_confi <- omega(sri_wide_confi)

# display the results 
print(omega_confi)

``` 

### 2.3 Situational Jugdement Test
```{r sjt, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# read in data
df_sjt <- 
  read_excel("./data/SJT.xlsx") 

# select relevant columns --> only subject ID and mean 
df_sjt <- df_sjt %>%
  dplyr::select(UI06_05, # ID
         SJT_AL_gek, # Monitoring
         SJT_ST_gek, # Managing momentum
         SJT_R_gek, # Rules and routines
         SJT_KF_gek) %>% # All
  filter(!UI06_05 == 201) # exclude ID with no eye tracking data

# remove NAs
df_sjt <- na.omit(df_sjt)


# rename columns
df_sjt <- rename(df_sjt, c("Group" = "UI06_05",
                           "Monitoring" = "SJT_AL_gek",
                           "Managing momentum" = "SJT_ST_gek",
                           "Rules and routines" = "SJT_R_gek",
                           "All" = "SJT_KF_gek"))


# changing from wide to long format
df_sjt_long <- df_sjt %>% 
  pivot_longer(!Group, names_to = "Facets Classroom Management", values_to = "Mean")

# define expert and novice with ifelse function
df_sjt_long$Group = ifelse(df_sjt_long$Group < 200, "Novice","Expert")


#################### N, MEAN & SD ############

# mean & SD SJT ALL
sjt_mean <- df_sjt_long %>%
  filter(`Facets Classroom Management` == "All") %>%
  group_by(Group) %>%
  summarise(N = n(),
            "M" = round(mean(Mean), 2),
            "SD" = round(sd(Mean), 2), 
            "Min" = round(min(Mean), 2),
            "Max" = round(max(Mean), 2), 
            )

# insert a table into HTML
knitr::kable(sjt_mean,
             caption = "N, M and SD for overall value")


# mean SJT Managing Momentum
sjt_mm <- df_sjt_long %>%
  filter(`Facets Classroom Management` == "Managing momentum") %>%
  group_by(Group) %>%
  summarise(N = n(),
            "M" = round(mean(Mean), 2),
            "SD" = round(sd(Mean), 2), 
            "Min" = round(min(Mean), 2),
            "Max" = round(max(Mean), 2), 
            )

# insert a table into HTML
knitr::kable(sjt_mm,
             caption = "N, M and SD for managing momentum")


# mean SJT Monitoring
sjt_m <- df_sjt_long %>%
  filter(`Facets Classroom Management` == "Monitoring") %>%
  group_by(Group) %>%
  summarise(N = n(),
            "M" = round(mean(Mean), 2),
            "SD" = round(sd(Mean), 2), 
            "Min" = round(min(Mean), 2),
            "Max" = round(max(Mean), 2), 
            )

# insert a table into HTML
knitr::kable(sjt_m,
             caption = "N, M and SD for monitoring")


# mean SJT Rules and routins
sjt_r <- df_sjt_long %>%
  filter(`Facets Classroom Management` == "Rules and routines") %>%
  group_by(Group) %>%
  summarise(N = n(),
            "M" = round(mean(Mean), 2),
            "SD" = round(sd(Mean), 2), 
            "Min" = round(min(Mean), 2),
            "Max" = round(max(Mean), 2), 
            )

# insert a table into HTML
knitr::kable(sjt_r,
             caption = "N, M and SD for rules and routines")


#################### Plots ############

# plotting mean of all aspects 
mean_plot <- 
df_sjt_long %>% 
  mutate(Group = factor(Group,
                        levels = c("Novice", 
                                   "Expert")
                        )
         ) %>% 
  ggplot(mapping = aes(x = Group,
                       y = Mean)) +
  geom_boxplot(mapping = aes(fill = Group), 
               outlier.shape = NA) +
  geom_point(size = 1, 
             alpha = 0.4,
             position = position_jitter(seed = 1, 
                                        width = 0.1,
                                        height = 0.1)) +
  labs(x = "") +
  ylim(0,1) + 
  scale_fill_brewer(palette  = "RdBu") +  
  facet_wrap(vars(`Facets Classroom Management`), 
             nrow = 1, strip.position = "bottom") +
  theme_cowplot() +
  ggtitle("SJT") +
    theme(
    plot.title = element_text(size = 25, 
                              face = "bold"),
    legend.title = element_text(size = 20),
    legend.text = element_text(size = 15),
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank(),
    strip.text.x = element_text(size = 8),
    axis.title.y = element_text(size = 20),
    axis.title.x = element_text(size = 22)
        )

mean_plot
```

#### t-test & effect size "STJ - All"
```{r sjt_all_ttest, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
#################### T-TEST & EFFECT SIZE ##################

# define expert and novice with ifelse function in wide format
df_sjt$Group = ifelse(df_sjt$Group < 200, "Novice","Expert")

#### ALL #### 
# t-test for expertise differences 
t.test(x = df_sjt$All[df_sjt$Group == "Expert"],
       y = df_sjt$All[df_sjt$Group == "Novice"],
       var.equal = TRUE)


# effect size for expertise differences
d_sjt_all <- CohenD(x = df_sjt$All[df_sjt$Group == "Expert"],
                    y = df_sjt$All[df_sjt$Group == "Novice"],
                    na.rm = TRUE
                    )

round(d_sjt_all, 2)

```

#### t-test & effect size "SJT - Managing momentum"
```{r sjt_mm, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

#### MANAGING MOMENTUM #### 
# t-test for expertise differences 
t.test(x = df_sjt$`Managing momentum`[df_sjt$Group == "Expert"],
       y = df_sjt$`Managing momentum`[df_sjt$Group == "Novice"],
       var.equal = TRUE
       )


# effect size for expertise differences
d_sjt_mm <- CohenD(x = df_sjt$`Managing momentum`[df_sjt$Group == "Expert"],
                   y = df_sjt$`Managing momentum`[df_sjt$Group == "Novice"],
                   na.rm = TRUE
                  )

round(d_sjt_mm, 2)
```

#### t-test & effect size "SJT - Monitoring"
```{r sjt_m, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

#### MONITORING ####
# t-test for expertise differences 
t.test(x = df_sjt$Monitoring[df_sjt$Group == "Expert"],
       y = df_sjt$Monitoring[df_sjt$Group == "Novice"],
       var.equal = TRUE
       )


# effect size for expertise differences
d_sjt_moni <- CohenD(x = df_sjt$Monitoring[df_sjt$Group == "Expert"],
                     y = df_sjt$Monitoring[df_sjt$Group == "Novice"],
                     na.rm = TRUE
                    )

round(d_sjt_moni, 2)
``` 

#### t-test & effect size "SJT - Rules & routines"
```{r sjt_rr, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

#### RULES & ROUTINES #### 
# t-test for expertise differences 
t.test(x = df_sjt$`Rules and routines`[df_sjt$Group == "Expert"],
       y = df_sjt$`Rules and routines`[df_sjt$Group == "Novice"],
       var.equal = TRUE
      )


# effect size for expertise differences
d_sjt_rr <- CohenD(x = df_sjt$`Rules and routines`[df_sjt$Group == "Expert"],
                   y = df_sjt$`Rules and routines`[df_sjt$Group == "Novice"],
                   na.rm = TRUE
                  )

round(d_sjt_rr, 2)

```

### Internal consistency (Omega) for SJT
```{r sjt_omega, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# read in data
df_sjt <- 
  read_excel("./data/SJT.xlsx")


### MANAGING MOMENTUM

# select relevant columns
df_sjt_mm <- df_sjt %>%
    dplyr::select(WT_S1_F1F2_AL:WT_S4_F4F6_AL)

# remove NAs
df_sjt_mm <- na.omit(df_sjt_mm)

# calculate omega with omega() function  
omega_sjt_mm <- omega(df_sjt_mm)

# display the results 
print(omega_sjt_mm)
 

### MONITORING

# select relevant columns
df_sjt_m <- df_sjt %>%
    dplyr::select(WT_S5_F1F2_ST:WT_S9_F4F5_ST)

# remove NAs
df_sjt_m <- na.omit(df_sjt_m)

# calculate omega with omega() function  
omega_sjt_m <- omega(df_sjt_m)

# display the results 
print(omega_sjt_m)


### RULES & ROUTINES 

# select relevant columns
df_sjt_r <- df_sjt %>%
  dplyr::select(WT_S11_F1F5_R:WT_S14_F4F6_R)

# remove NAs
df_sjt_r <- na.omit(df_sjt_r)

# calculate omega with omega() function  
omega_sjt_r <- omega(df_sjt_r)

# display the results 
print(omega_sjt_r)

``` 

### 2.4 Classroom Questionnaire
```{r classroom questionnaire, echo=FALSE, results='asis'}

# load data files with modified scales
df_quest <- read_excel("./data/data_empschul_labor_lehrperson.xlsx") %>%
  dplyr::select(LI06_05,
                LM01_01:LM01_08, # classroom management 
                LP01_01:LP01_08) %>% # non- & paraverbal communication 
  filter(!LI06_05 == 201) %>% # exclude ID with no eye tracking data
  mutate(LI06_05 = ifelse(LI06_05 < 200, "Novice", "Expert")) %>% 
  rename(Group = LI06_05)

# remove NAs
df_quest <- na.omit(df_quest)

# create table with means
df_quest_table <-
  df_quest %>%
  group_by(Group) %>%
  summarise(
    N = n(),
    "M cm" = round(mean(c_across(starts_with(
      "LM"
    )), na.rm = TRUE), 2),
    "SD cm" = round(sd(c_across(starts_with(
      "LM"
    )), na.rm = TRUE), 2),
    "Min cm" = round(min(c_across(starts_with(
      "LM"
    )), na.rm = TRUE), 2),
    "Max cm" = round(max(c_across(starts_with(
      "LM"
    )), na.rm = TRUE), 2),
    # "N cm" = length(c_across(starts_with("LP")), na.rm = TRUE),
    "M n&pv com" = round(mean(c_across(starts_with(
      "LP"
    )), na.rm = TRUE), 2),
    "SD n&pv com" = round(sd(c_across(starts_with(
      "LP"
    )), na.rm = TRUE), 2),
    "Min n&pv com" = round(min(c_across(starts_with(
      "LP"
    )), na.rm = TRUE), 2),
    "Max n&pv com" = round(max(c_across(starts_with(
      "LP"
    )), na.rm = TRUE), 2)
  ) 

knitr::kable(df_quest_table,
             caption = "Mean, SD, min, max for classroom managament (cm) and non-/paraverbal communication (n&pv com)")


#################### Plots ############

# create table with means
df_quest_plot <-
  df_quest %>%
  rowwise() %>% 
  transmute(Group = Group,
            "All" = round(mean(c_across(starts_with("L")), na.rm = TRUE), 2),
            "Classroom management" = round(mean(c_across(starts_with("LM")), na.rm = TRUE), 2),
            "Non-/paraverbal communication" = round(mean(c_across(starts_with("LP")), na.rm = TRUE), 2)
            )
    
    
# changing from wide to long format
df_quest_long <- df_quest_plot %>% 
  pivot_longer(!Group, names_to = "Scales Classroom Questionnaire", values_to = "Mean")

# plotting mean of all aspects 
quest_plot <- 
df_quest_long %>% 
  mutate(Group = factor(Group,
                        levels = c("Novice", 
                                   "Expert")
                        )
         ) %>% 
  ggplot(mapping = aes(x = Group,
                       y = Mean)) +
  geom_boxplot(mapping = aes(fill = Group), 
               outlier.shape = NA) +
  geom_point(size = 1, 
             alpha = 0.4,
             position = position_jitter(seed = 1, 
                                        width = 0.1,
                                        height = 0.1)) +
  labs(x = "") +
  ylim(0,4) + 
  scale_fill_brewer(palette  = "RdBu") +  
  facet_wrap(vars(`Scales Classroom Questionnaire`), 
             nrow = 1, strip.position = "bottom") +
  theme_cowplot() +
  ggtitle("Classroom Questionnaire") +
    theme(
    plot.title = element_text(size = 25, 
                              face = "bold"),
    legend.title = element_text(size = 20),
    legend.text = element_text(size = 15),
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank(),
    strip.text.x = element_text(size = 8),
    axis.title.y = element_text(size = 20),
    axis.title.x = element_text(size = 22)
        )

quest_plot
```

#### t-test & effect size "Classroom Questionnaire - All"
```{r classroom questionnaire_all, echo=FALSE, results='asis'}

#################### T-TEST & EFFECT SIZE ##################

#### All #### 
# t-test for expertise differences 
t.test(x = df_quest_plot$All[df_quest_plot$Group == "Expert"],
       y = df_quest_plot$All[df_quest_plot$Group == "Novice"],
       var.equal = TRUE
       )


# effect size for expertise differences
d_quest_all <- CohenD(x = df_quest_plot$All[df_quest_plot$Group == "Expert"],
                      y = df_quest_plot$All[df_quest_plot$Group == "Novice"],
                      na.rm = TRUE
                      )

round(d_quest_all, 2)

```

#### t-test & effect size "Classroom Questionnaire - Classroom Management"
```{r classroom questionnaire_cm, echo=FALSE, results='asis'}

#### Classroom Management #### 
# t-test for expertise differences 
t.test(x = df_quest_plot$`Classroom management`[df_quest_plot$Group == "Expert"],
       y = df_quest_plot$`Classroom management`[df_quest_plot$Group == "Novice"],
       var.equal = TRUE)


# effect size for expertise differences
d_quest_cm <- CohenD(x = df_quest_plot$`Classroom management`[df_quest_plot$Group == "Expert"],
                      y = df_quest_plot$`Classroom management`[df_quest_plot$Group == "Novice"],
                      na.rm = TRUE
                      )

round(d_quest_cm, 2)
```

#### t-test & effect size "Classroom Questionnaire - Non-/paraverbal communication"
```{r classroom questionnaire_npvc, echo=FALSE, results='asis'}

#### Non-/paraverbal communication #### 
# t-test for expertise differences 
t.test(x = df_quest_plot$`Non-/paraverbal communication`[df_quest_plot$Group == "Expert"],
       y = df_quest_plot$`Non-/paraverbal communication`[df_quest_plot$Group == "Novice"],
       var.equal = TRUE)


# effect size for expertise differences
d_quest_npvc <- CohenD(x = df_quest_plot$`Non-/paraverbal communication`[df_quest_plot$Group == "Expert"],
                      y = df_quest_plot$`Non-/paraverbal communication`[df_quest_plot$Group == "Novice"],
                      na.rm = TRUE
                      )

round(d_quest_npvc, 2)

```

### Internal consistency (Omega) for Classroom Questionnaire
```{r cm_omega, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

# read in data
df_quest <- read_excel("./data/data_empschul_labor_lehrperson.xlsx") %>%
  dplyr::select(LM01_01:LM01_08, # classroom management 
                LP01_01:LP01_08) # non- & paraverbal communication 



### CLASSROOM MANAGEMENT

# select relevant columns
df_quest_cm <- df_quest %>%
    dplyr::select(LM01_01:LM01_08)

# remove NAs
df_quest_cm <- na.omit(df_quest_cm)

# calculate omega with omega() function  
omega_quest_cm <- omega(df_quest_cm)

# display the results 
print(omega_quest_cm)
 

### NON- & PARAVERBAL COMMUNICATION

# select relevant columns
df_quest_npvc <- df_quest %>%
    dplyr::select(LP01_01:LP01_08)

# remove NAs
df_quest_npvc <- na.omit(df_quest_npvc)

# calculate omega with omega() function  
omega_quest_npvc <- omega(df_quest_npvc)

# display the results 
print(omega_quest_npvc)


``` 


## 3. Correlations
```{r correlations, echo=FALSE, message=FALSE, warning=FALSE}

# Define excluded IDs for easy updating
excluded_ids <- c(201, 223)

# 1. Demo Data
df_demo <- read_excel("./data/data_empschul_labor_lehrperson.xlsx") %>%
  filter(!LI06_05 %in% excluded_ids) %>% # Exclude participants based on IDs
  transmute(Participant = LI06_05, Teaching_Experience = LI04_01) %>%
  arrange(Participant)

# 2. Aggregate AOI Data (Micro-teaching Unit)
df_aoi_numb_dur <- df_aoi %>%
  filter(TOI == "Lesson") %>%
  select(
    Participant,
    Duration_of_interval,
    starts_with("Total_duration_of_fixations"),
    starts_with("Number_of_fixations"),
    starts_with("Average_duration")
  ) %>%
  select(-ends_with("Disruptive_Person")) %>% # Exclude "Disruptive_Person" columns
  mutate(Duration_of_interval_min = Duration_of_interval / 60000) %>%
  rowwise() %>%
  summarize(
    Participant,
    Sum_duration_fixation = sum(c_across(starts_with("Total_duration")), na.rm = TRUE),
    Sum_number_fixation = sum(c_across(starts_with("Number_of")), na.rm = TRUE),
    Average_duration_mtu = round(Sum_duration_fixation / Sum_number_fixation, digits = 0),
    Number_fixation_min_mtu = round(Sum_number_fixation / Duration_of_interval_min, digits = 0),
    GRI_mtu = round(Average_duration_mtu / Number_fixation_min_mtu, digits = 2)
  ) %>%
  select(Participant,
         Number_fixation_min_mtu,
         Average_duration_mtu,
         GRI_mtu)

# 3. Aggregate AOI Data (Students)
df_aoi_stud <- df_aoi %>%
  filter(TOI == "Lesson") %>%
  select(
    Participant,
    Duration_of_interval,
    starts_with("Total_duration_of_fixations."),
    starts_with("Number_of_fixations.")
  ) %>%
  mutate(Duration_of_interval_min = Duration_of_interval / 60000) %>%
  rowwise() %>%
  summarize(
    Participant,
    Stud_duration_fixation = sum(c_across(starts_with("Total_duration")), na.rm = TRUE),
    Stud_number_fixation = sum(c_across(starts_with("Number_of")), na.rm = TRUE),
    Stud_number_fixation_min = round(Duration_of_interval_min / Stud_number_fixation, digits = 2),
    Average_duration_stud = round(Stud_duration_fixation / Stud_number_fixation, digits = 0),
    GRI_stud = round(Average_duration_stud / Stud_number_fixation_min, digits = 2)
  ) %>%
  select(Participant,
         Stud_number_fixation_min,
         Average_duration_stud,
         GRI_stud)

# 4. Aggregate AOI Data (Disruptive Person)
df_aoi_disrup <- df_aoi %>%
  filter(TOI == "Lesson") %>%
  select(
    Participant,
    Total_duration_of_fixations.Disruptive_Person,
    Number_of_fixations.Disruptive_Person
  ) %>%
  mutate(
    Average_duration_disrup = round(
      Total_duration_of_fixations.Disruptive_Person / Number_of_fixations.Disruptive_Person,
      digits = 0
    ),
    GRI_disrup = round(
      Average_duration_disrup / Number_of_fixations.Disruptive_Person,
      digits = 2
    )
  ) %>%
  select(
    Participant,
    Number_of_fixations.Disruptive_Person,
    Average_duration_disrup,
    GRI_disrup
  )

# 5. Time to First Fixation on Disruptive Person
df_ttff_disrup <- df_aoi %>%
  filter(
    TOI %in% c(
      "Chatting_with_neighbour",
      "Clicking_pen",
      "Drawing",
      "Drumming_with_hands",
      "Head_on_table",
      "Heckling",
      "Looking_at_phone",
      "Snipping_with_fingers",
      "Whispering"
    )
  ) %>%
  select(Participant, TOI, Time_to_first_fixation.Disruptive_Person) %>%
  filter(
    !is.na(Time_to_first_fixation.Disruptive_Person) &
      Time_to_first_fixation.Disruptive_Person > 0 &
      Time_to_first_fixation.Disruptive_Person <= 30000
  ) %>%
  group_by(Participant) %>%
  summarize(
    N = n(),
    Time_to_first_fixation_Disruptive_Person_Sum = mean(Time_to_first_fixation.Disruptive_Person),
    Group = ifelse(Participant < 200, "Novice", "Expert"),
    Sum_disruptions = sum(N),
    Disrup_time_fixation_sec = round(Time_to_first_fixation_Disruptive_Person_Sum / 1000, 2)
  )

# 6. Rating Scales
df_sri <- excel_sheets("data/Coding_SRI.xlsx") %>%
  map_df( ~ read_xlsx("data/Coding_SRI.xlsx", .)) %>%
  filter(
    !ID %in% excluded_ids,
    !disruption_appraisal %in% c(-100, -99, -88),
    !confidence_appraisal %in% c(-100, -99, -88),
    !prevalence_rating %in% c(-100, -99, -88)
  ) %>%
  rename(Participant = ID) %>%
  group_by(Participant) %>%
  summarize(
    Mean_disruption_appraisal = round(mean(disruption_appraisal), 2),
    Mean_confidence_appraisal = round(mean(confidence_appraisal), 2),
    Mean_prevalence_rating = round(mean(prevalence_rating), 2)
  )

# 7. Situational Judgment Test (SJT) Data
df_sjt <- read_excel("./data/SJT.xlsx") %>%
  filter(!UI06_05 %in% excluded_ids) %>%
  transmute(
    Participant = UI06_05,
    SJT_Monitoring = round(SJT_AL_gek, 2),
    SJT_All = round(SJT_KF_gek, 2)
  )

# 8. Classroom Questionnaire
df_quest <- read_excel("./data/data_empschul_labor_lehrperson.xlsx") %>%
  dplyr::select(LI06_05, LM01_01:LM01_08, # classroom management
                LP01_01:LP01_08) %>% # non- & paraverbal communication
  filter(!LI06_05 %in% excluded_ids) %>% # exclude ID with no eye tracking data
  rename(Participant = LI06_05) %>%
  group_by(Participant) %>%
  transmute(
    Participant = Participant,
    "Quest_All" = round(mean(c_across(starts_with(
      "L"
    )), na.rm = TRUE), 2),
    "Quest_classroom_management" = round(mean(c_across(starts_with(
      "LM"
    )), na.rm = TRUE), 2),
    "Quest_non_paraverbal_communication" = round(mean(c_across(starts_with(
      "LP"
    )), na.rm = TRUE), 2)
  )

# 9. Combine All Data Frames into a Single Data Frame
df_list <- list(
  df_demo,
  df_aoi_numb_dur,
  df_aoi_stud,
  df_aoi_disrup,
  df_ttff_disrup,
  df_sri,
  df_sjt,
  df_quest
)

df_merge <- df_list %>%
  reduce(full_join, by = "Participant") %>%
  select(
    Participant,
    Teaching_Experience,
    GRI_mtu,
    SJT_All,
    Quest_All,
    Mean_disruption_appraisal,
    Mean_confidence_appraisal
  ) %>%
  drop_na()  # Drop rows with any NA values (if needed)


# Display the merged dataframe (optional)
print(df_merge)

# create a correlation matrix
cor_tab <- 
  df_merge %>% 
  cor(method = "pearson") %>% 
  round(., digits = 2)

### Only experts
# merge all data frames in list
df_merge_experts <-
df_merge %>% 
  filter(Teaching_Experience > 0) %>% 
  dplyr::select(
    Participant,
    Teaching_Experience,
    GRI_mtu,
    SJT_All,
    Quest_All,
    Mean_disruption_appraisal,
    Mean_confidence_appraisal
  ) %>%
  drop_na()  # Drop rows with any NA values (if needed)

# create a correlation matrix
cor_tab_experts <- 
  df_merge_experts %>% 
  cor(method = "pearson") %>% 
  round(., digits = 2)


### Only novices
# merge all data frames in list
df_merge_novice <-
df_merge %>% 
  filter(Teaching_Experience == 0) %>% 
  dplyr::select(
    Participant,
    Teaching_Experience,
    GRI_mtu,
    SJT_All,
    Quest_All,
    Mean_disruption_appraisal,
    Mean_confidence_appraisal
  ) %>%
  drop_na()  # Drop rows with any NA values (if needed)

# create a correlation matrix
cor_tab_novices <- 
  df_merge_novice %>% 
  cor(method = "pearson") %>% 
  round(., digits = 2)

# p-value for GRI x STJ_All
cor.test(df_merge_novice$GRI_mtu, df_merge_novice$SJT_All)

# p-value for GRI x Rating
cor.test(df_merge_novice$Quest_All, df_merge_novice$Mean_confidence_appraisal)

# p-value for GRI x Teaching Experience
cor.test(df_merge_experts$GRI_mtu, df_merge_experts$`Teaching Experience`)

```

