fit_pre_1 <-
df_multi %>%
filter(Phase == "Pre Teaching Phase") %>%
lm(slope ~ teaching_experience)
fit_pre_1 <-
df_multi %>%
filter(Phase == "Pre Teaching Phase") %>%
lm(slope ~ teaching_experience)
fit_pre_1 <-
df_multi %>%
filter(Phase == "Pre Teaching Phase") %>%
lm(slope ~ teaching_experience,
data = .)
summary(fit_pre_1)
# multiple bpm values (merged data frame for multiple regression with multiple measurement points)
main_multiple_hr <-
left_join(main_single_hr,
df_merge,
by = "ID")
main_multiple_hr %>%
group_by(ID, time_span) %>%
summarise(disruption_factor = mean(disruption_factor,
na.rm = T),
confidence_factor = mean(confidence_factor,
na.rm = T),
teaching_experience = mean(teaching_experience),
heart_rate = mean(heart_rate_std)
) %>%
ungroup() -> data_regression_mean
## loop for regression model
for (i in unique(data_regression_mean$time_span)) {
cache <- data_regression_mean %>%
filter(time_span == i)
regr1 <-
lm(heart_rate ~ teaching_experience,
data = cache) %>%
lm.beta()
assign(value = regr1,
x = paste0("regr_", i, "1"))
regr2 <-
lm(heart_rate ~ teaching_experience + disruption_factor,
data = cache) %>%
lm.beta()
assign(value = regr2,
x = paste0("regr_", i, "2"))
regr3 <-
lm(heart_rate ~ teaching_experience + confidence_factor,
data = cache) %>%
lm.beta()
assign(value = regr3,
x = paste0("regr_", i, "3"))
regr4 <-
lm(heart_rate ~ teaching_experience + disruption_factor + confidence_factor,
data = cache) %>%
lm.beta()
assign(value = regr4,
x = paste0("regr_", i, "4"))
}
summary(regr_preparation1)
summary(regr_end2)
citation('ggplot2')
View(desc_hr_phases_std)
View(df_heart_rate)
View(df_merge)
tinytex::tlmgr_install(pkgs = 'citation-style-language.sty')
tinytex::tlmgr_install(pkgs = 'citation-style-language')
View(filter_overall)
knitr::opts_chunk$set(echo = FALSE, fig.width = 8, fig.height = 4, cache = TRUE)
main_single_hr |>
filter(time > 7200) |>
distinct(ID, .keep_all = TRUE) -> filter_overall
library(needs)
needs(ltm,
broom,
ppcor,
jtools,
lm.beta,
tidyverse,
janitor,
lubridate,
readxl,
ggthemes,
gridExtra,
imputeTS,
DescTools,
cowplot,
rstatix,
ggpubr,
lme4,
viridis,
stargazer,
papaja,
grid,
purrr)
main_single_hr |>
filter(time > 7200) |>
distinct(ID, .keep_all = TRUE) -> filter_overall
View(filter_overall)
knitr::opts_chunk$set(
echo = TRUE,
error = FALSE,
message = FALSE,
warning = FALSE
)
mods <-
df_regression %>%
split(.$time_span) %>%
map(~ lm(formula = heart_rate_std ~ 0 + ID + time:ID,
data = .
)
)
knitr::opts_chunk$set(echo = FALSE, fig.width = 8, fig.height = 4, cache = TRUE)
library(needs)
needs(ltm,
broom,
ppcor,
jtools,
lm.beta,
tidyverse,
janitor,
lubridate,
readxl,
ggthemes,
gridExtra,
imputeTS,
DescTools,
cowplot,
rstatix,
ggpubr,
lme4,
viridis,
stargazer,
papaja,
grid,
purrr)
mods <-
df_regression %>%
split(.$time_span) %>%
map(~ lm(formula = heart_rate_std ~ 0 + ID + time:ID,
data = .
)
)
graph_data <-
df_regression %>%
split(.$time_span)
example <- list(mod = mods$preparation, data = graph_data$preparation)
list(`Preparation Phase` = list(name = "Pre-Teaching Interval", mod = mods$preparation, data = graph_data$preparation),
`Teaching Phase` = list(name = "Teaching Interval", mod = mods$teaching, data = graph_data$teaching),
`Post Teaching Phase` = list(name = "Post-Teaching Interval",mod = mods$post, data = graph_data$post),
`Interview Phase` = list(name = "Interview Interval",mod = mods$interview, data = graph_data$interview),
`End Phase` = list(name = "End Interval",mod = mods$end, data = graph_data$end)
) %>%
map(~ ggplot(data = .$data,
mapping = aes(x = time,
y = heart_rate_std,
group = ID)) +
geom_line(mapping = aes(y = fitted(.$mod)),
color = "blue",
size = 1) +
geom_point(alpha = 0.5,
size = 0.5) +
labs(title = .$name,
y = "Heart Rate (Standardized)",
x = "Time (in Seconds)") +
facet_wrap( ~ ID, nrow = 6) +
theme_apa()
)
plot_list_appendix <- list(
`Preparation Phase` = list(name = "Pre-Teaching Interval", mod = mods$preparation, data = graph_data$preparation),
`Teaching Phase` = list(name = "Teaching Interval", mod = mods$teaching, data = graph_data$teaching),
`Post Teaching Phase` = list(name = "Post-Teaching Interval",mod = mods$post, data = graph_data$post),
`Interview Phase` = list(name = "Interview Interval",mod = mods$interview, data = graph_data$interview),
`End Phase` = list(name = "End Interval",mod = mods$end, data = graph_data$end)
) %>%
map(~ ggplot(data = .$data,
mapping = aes(x = time,
y = heart_rate_std,
group = ID)) +
geom_line(mapping = aes(y = fitted(.$mod)),
color = "blue",
size = 1) +
geom_point(alpha = 0.5,
size = 0.5) +
labs(title = .$name,
y = "Heart Rate (Standardized)",
x = "Time (in Seconds)") +
facet_wrap( ~ ID, nrow = 6) +
theme_apa()
)
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 20,
height = 12,
units = "cm")
preparation_plot <- plot_list$`Preparation Phase`
preparation_plot <- plot_list_appendix$`Preparation Phase`
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 20,
height = 12,
units = "cm")
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 20,
height = 12,
units = "cm")
ggsave(teaching_plot,
filename = "plots_publication/plot_teaching_appendix.pdf",
width = 20,
height = 12,
units = "cm")
teaching_plot <- plot_list_appendix$`Teaching Phase`
post_teaching_plot <- plot_list_appendix$`Post Teaching Phase`
interview_plot <- plot_list_appendix$`Interview Phase`
end_plot <- plot_list_appendix$`End Phase`
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 20,
height = 12,
units = "cm")
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 20,
height = 12,
units = "cm")
ggsave(teaching_plot,
filename = "plots_publication/plot_teaching_appendix.pdf",
width = 20,
height = 12,
units = "cm")
ggsave(post_teaching_plot,
filename = "plots_publication/plot_post_teaching_appendix.pdf",
width = 20,
height = 12,
units = "cm")
ggsave(interview_plot,
filename = "plots_publication/plot_interview_appendix.pdf",
width = 20,
height = 12,
units = "cm")
ggsave(end_plot,
filename = "plots_publication/plot_end_appendix.pdf",
width = 20,
height = 12,
units = "cm")
knitr::opts_chunk$set(
echo = TRUE,
error = FALSE,
message = FALSE,
warning = FALSE
)
mods <-
df_regression %>%
split(.$time_span) %>%
map(~ lm(formula = heart_rate_std ~ 0 + ID + time:ID,
data = .
)
)
graph_data <-
df_regression %>%
split(.$time_span)
example <- list(mod = mods$preparation, data = graph_data$preparation)
list(`Preparation Phase` = list(name = "Pre-Teaching ", mod = mods$preparation, data = graph_data$preparation),
`Teaching Phase` = list(name = "Teaching Phase", mod = mods$teaching, data = graph_data$teaching),
`Post Teaching Phase` = list(name = "Post Teaching Phase",mod = mods$post, data = graph_data$post),
`Interview Phase` = list(name = "Interview Phase",mod = mods$interview, data = graph_data$interview),
`End Phase` = list(name = "End Phase",mod = mods$end, data = graph_data$end)
) %>%
map(~ ggplot(data = .$data,
mapping = aes(x = time,
y = heart_rate_std,
group = ID)) +
geom_line(mapping = aes(y = fitted(.$mod)),
color = "blue",
size = 1) +
geom_point(alpha = 0.5,
size = 0.5) +
labs(title = .$name,
y = "Heart Rate (Standardized)",
x = "Time (in Seconds)") +
facet_wrap( ~ ID, nrow = 6) +
theme_apa()
)
mods <-
df_regression %>%
split(.$time_span) %>%
map(~ lm(formula = heart_rate_std ~ 0 + ID + time:ID,
data = .
)
)
graph_data <-
df_regression %>%
split(.$time_span)
example <- list(mod = mods$preparation, data = graph_data$preparation)
plot_list_appendix <- list(
`Preparation Phase` = list(name = "Pre-Teaching Interval", mod = mods$preparation, data = graph_data$preparation),
`Teaching Phase` = list(name = "Teaching Interval", mod = mods$teaching, data = graph_data$teaching),
`Post Teaching Phase` = list(name = "Post-Teaching Interval",mod = mods$post, data = graph_data$post),
`Interview Phase` = list(name = "Interview Interval",mod = mods$interview, data = graph_data$interview),
`End Phase` = list(name = "End Interval",mod = mods$end, data = graph_data$end)
) %>%
map(~ ggplot(data = .$data,
mapping = aes(x = time,
y = heart_rate_std,
group = ID)) +
geom_line(mapping = aes(y = fitted(.$mod)),
color = "blue",
size = 1) +
geom_point(alpha = 0.5,
size = 0.5) +
labs(title = .$name,
y = "Heart Rate (Standardized)",
x = "Time (in Seconds)") +
facet_wrap( ~ ID, nrow = 6) +
theme_apa()
)
preparation_plot <- plot_list_appendix$`Preparation Phase`
teaching_plot <- plot_list$`Teaching Phase`
post_teaching_plot <- plot_list$`Post Teaching Phase`
interview_plot <- plot_list$`Interview Phase`
View(preparation_plot)
preparation_plot
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 20,
height = 20,
units = "cm")
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 27,
height = 15,
units = "cm")
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 20,
height = 50,
units = "cm")
plot_list_appendix <- list(
`Preparation Phase` = list(name = "Pre-Teaching Interval", mod = mods$preparation, data = graph_data$preparation),
`Teaching Phase` = list(name = "Teaching Interval", mod = mods$teaching, data = graph_data$teaching),
`Post Teaching Phase` = list(name = "Post-Teaching Interval",mod = mods$post, data = graph_data$post),
`Interview Phase` = list(name = "Interview Interval",mod = mods$interview, data = graph_data$interview),
`End Phase` = list(name = "End Interval",mod = mods$end, data = graph_data$end)
) %>%
map(~ ggplot(data = .$data,
mapping = aes(x = time,
y = heart_rate_std,
group = ID)) +
geom_line(mapping = aes(y = fitted(.$mod)),
color = "blue",
size = 1) +
geom_point(alpha = 0.5,
size = 0.5) +
scale_x_discrete()
labs(title = .$name,
plot_list_appendix <- list(
`Preparation Phase` = list(name = "Pre-Teaching Interval", mod = mods$preparation, data = graph_data$preparation),
`Teaching Phase` = list(name = "Teaching Interval", mod = mods$teaching, data = graph_data$teaching),
`Post Teaching Phase` = list(name = "Post-Teaching Interval",mod = mods$post, data = graph_data$post),
`Interview Phase` = list(name = "Interview Interval",mod = mods$interview, data = graph_data$interview),
`End Phase` = list(name = "End Interval",mod = mods$end, data = graph_data$end)
) %>%
map(~ ggplot(data = .$data,
mapping = aes(x = time,
y = heart_rate_std,
group = ID)) +
geom_line(mapping = aes(y = fitted(.$mod)),
color = "blue",
size = 1) +
geom_point(alpha = 0.5,
size = 0.5) +
scale_x_discrete()+
labs(title = .$name,
y = "Heart Rate (Standardized)",
x = "Time (in Seconds)") +
facet_wrap( ~ ID, nrow = 6) +
theme_apa()
)
preparation_plot <- plot_list_appendix$`Preparation Phase`
preparation_plot
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 20,
height = 50,
units = "cm")
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 20,
height = 25,
units = "cm")
?scale_x_discrete()
plot_list_appendix <- list(
`Preparation Phase` = list(name = "Pre-Teaching Interval", mod = mods$preparation, data = graph_data$preparation),
`Teaching Phase` = list(name = "Teaching Interval", mod = mods$teaching, data = graph_data$teaching),
`Post Teaching Phase` = list(name = "Post-Teaching Interval",mod = mods$post, data = graph_data$post),
`Interview Phase` = list(name = "Interview Interval",mod = mods$interview, data = graph_data$interview),
`End Phase` = list(name = "End Interval",mod = mods$end, data = graph_data$end)
) %>%
map(~ ggplot(data = .$data,
mapping = aes(x = time,
y = heart_rate_std,
group = ID)) +
geom_line(mapping = aes(y = fitted(.$mod)),
color = "blue",
size = 1) +
geom_point(alpha = 0.5,
size = 0.5) +
scale_x_discrete(limits = c(0, 10),
breaks = 5) +
labs(title = .$name,
y = "Heart Rate (Standardized)",
x = "Time (in Seconds)") +
facet_wrap( ~ ID, nrow = 6) +
theme_apa()
)
plot_list_appendix <- list(
`Preparation Phase` = list(name = "Pre-Teaching Interval", mod = mods$preparation, data = graph_data$preparation),
`Teaching Phase` = list(name = "Teaching Interval", mod = mods$teaching, data = graph_data$teaching),
`Post Teaching Phase` = list(name = "Post-Teaching Interval",mod = mods$post, data = graph_data$post),
`Interview Phase` = list(name = "Interview Interval",mod = mods$interview, data = graph_data$interview),
`End Phase` = list(name = "End Interval",mod = mods$end, data = graph_data$end)
) %>%
map(~ ggplot(data = .$data,
mapping = aes(x = time,
y = heart_rate_std,
group = ID)) +
geom_line(mapping = aes(y = fitted(.$mod)),
color = "blue",
size = 1) +
geom_point(alpha = 0.5,
size = 0.5) +
scale_x_discrete(limits = c('0, 10'),
breaks = 5) +
labs(title = .$name,
y = "Heart Rate (Standardized)",
x = "Time (in Seconds)") +
facet_wrap( ~ ID, nrow = 6) +
theme_apa()
)
preparation_plot <- plot_list_appendix$`Preparation Phase`
preparation_plot
plot_list_appendix <- list(
`Preparation Phase` = list(name = "Pre-Teaching Interval", mod = mods$preparation, data = graph_data$preparation),
`Teaching Phase` = list(name = "Teaching Interval", mod = mods$teaching, data = graph_data$teaching),
`Post Teaching Phase` = list(name = "Post-Teaching Interval",mod = mods$post, data = graph_data$post),
`Interview Phase` = list(name = "Interview Interval",mod = mods$interview, data = graph_data$interview),
`End Phase` = list(name = "End Interval",mod = mods$end, data = graph_data$end)
) %>%
map(~ ggplot(data = .$data,
mapping = aes(x = time,
y = heart_rate_std,
group = ID)) +
geom_line(mapping = aes(y = fitted(.$mod)),
color = "blue",
size = 1) +
geom_point(alpha = 0.5,
size = 0.5) +
scale_x_discrete(limits = c('0, 10'),
breaks = 5) +
labs(title = .$name,
y = "Heart Rate (Standardized)",
x = "Time (in Seconds)") +
facet_wrap( ~ ID, nrow = 6) +
theme_apa()
)
scale_x_continuous(breaks = c(0, 5, 10) +
plot_list_appendix <- list(
`Preparation Phase` = list(name = "Pre-Teaching Interval", mod = mods$preparation, data = graph_data$preparation),
`Teaching Phase` = list(name = "Teaching Interval", mod = mods$teaching, data = graph_data$teaching),
`Post Teaching Phase` = list(name = "Post-Teaching Interval",mod = mods$post, data = graph_data$post),
`Interview Phase` = list(name = "Interview Interval",mod = mods$interview, data = graph_data$interview),
`End Phase` = list(name = "End Interval",mod = mods$end, data = graph_data$end)
) %>%
map(~ ggplot(data = .$data,
mapping = aes(x = time,
y = heart_rate_std,
group = ID)) +
geom_line(mapping = aes(y = fitted(.$mod)),
color = "blue",
size = 1) +
geom_point(alpha = 0.5,
size = 0.5) +
scale_x_continuous(breaks = c(0, 5, 10)) +
labs(title = .$name,
y = "Heart Rate (Standardized)",
x = "Time (in Seconds)") +
facet_wrap( ~ ID, nrow = 6) +
theme_apa()
)
preparation_plot <- plot_list_appendix$`Preparation Phase`
preparation_plot <- plot_list_appendix$`Preparation Phase`
preparation_plot
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 20,
height = 25,
units = "cm")
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 15,
height = 20,
units = "cm")
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 15,
height = 15,
units = "cm")
ggsave(preparation_plot,
filename = "plots_publication/plot_preparation_appendix.pdf",
width = 25,
height = 25,
units = "cm")
