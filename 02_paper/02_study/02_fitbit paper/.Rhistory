map_df(~read_xlsx("data/Coding_SRI.xlsx",.)) %>% # read in data with two sheets
select(ID, # select relevant columns
disruption_factor, # -99 = subject did not notice event; -100 = experimenter did not asked for event
confidence_factor,
event
) %>%
mutate(disruption_factor = ifelse(disruption_factor < 0,
yes = NA,
no = disruption_factor
),
confidence_factor = ifelse(confidence_factor < 0,
yes = NA,
no = confidence_factor),
event = as_factor(event)
)
# demographic data
df_demo <-
read_excel("./data/data_empschul_labor_lehrperson.xlsx") %>% # read in excel
transmute(ID = LI06_05, # select and rename relevant columns
gender = factor(LI02_01_1,
levels = 1:2,
labels = c("male","female")
),
age = LI03_01, # 1 = male; 2 = female
teaching_experience = LI04_01)
# merge two data frames by ID
df_merge <- merge(df_demo,
df_rating,
by = "ID") %>%
filter(!ID %in% c("126", # exclude cases with no fitbit data (to check see data Heart Rate)
"132")
)
# rm(list = c("df_demo","df_rating"))
data_path <- "./data/heart_rate_data"
main <-
map(.x = dir(path = data_path,
pattern = ".csv"),
~ read_csv(file.path(data_path, .),
id = "id",
col_types = c("t","n")
) %>%
mutate(time = .$Time - min(.$Time),
time = as.numeric(time),
heart_rate = `Heart Rate`,
ID = id,
time_span = case_when(str_detect(string = id, pattern = "_a") ~ "after",
str_detect(string = id, pattern = "_m") ~ "main",
str_detect(string = id, pattern = "_p") ~ "pre",
str_detect(string = id, pattern = "_s") ~ "subsequent",
str_detect(string = id, pattern = "_i") ~ "interview",
TRUE ~ "overall"
),
ID = str_extract(string = ID,
pattern = "[:digit:]{3}"),
ID = as.numeric(ID)
) %>%
# filter(time <= 600) %>% # filter for 10min intervals
filter(time <= 9000) %>% # filter for 2 hours 30min (maximal duration of study)
select(!c("Time","Heart Rate","id"))
) %>%
bind_rows()
main <-
left_join(main, df_merge,
by = "ID")
knitr::include_graphics("./images/timeline_fitbit.png", dpi = 130)
main %>%
filter(time_span == "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
# stat_smooth(geom = "line",
#             method = "loess",
#             se = FALSE) +
geom_smooth(method = "loess",
se = FALSE) +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa()
main %>%
filter(time_span == "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
stat_smooth(geom = "line",
method = "loess",
se = FALSE) +
geom_smooth(method = "loess",
se = FALSE) +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa()
main %>%
filter(time_span != "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
mutate(status = case_when(ID < 200 ~ "Unerfahren",
ID > 200 ~ "Erfahren"),
time_span = fct_recode(time_span,
"Pre-Lehrphase" = "pre",
"Lehrphase" = "main",
"Post-Lehrphase" = "subsequent",
"Intviewphase" = "interview",
"Endphase" = "after"
),
time_span = factor(time_span,
levels = c("Pre-Lehrphase",
"Lehrphase",
"Post-Lehrphase",
"Intviewphase",
"Endphase"
)
)
) %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
# stat_smooth(geom = "line",
# mapping = aes(color = status),
#            method = "loess",
#           se = TRUE)
geom_smooth(method = "glm") +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa() +
facet_grid(cols = vars(time_span),
scales = "free_x",
)
main %>%
filter(time_span != "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
mutate(status = case_when(ID < 200 ~ "Unerfahren",
ID > 200 ~ "Erfahren"),
time_span = fct_recode(time_span,
"Pre-Lehrphase" = "pre",
"Lehrphase" = "main",
"Post-Lehrphase" = "subsequent",
"Interviewphase" = "interview",
"Endphase" = "after"
),
time_span = factor(time_span,
levels = c("Pre-Lehrphase",
"Lehrphase",
"Post-Lehrphase",
"Interviewphase",
"Endphase"
)
)
) %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
# stat_smooth(geom = "line",
# mapping = aes(color = status),
#            method = "loess",
#           se = TRUE)
geom_smooth(method = "glm") +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa() +
facet_grid(cols = vars(time_span),
scales = "free_x",
)
main %>%
filter(time_span == "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
stat_smooth(geom = "line",
method = "loess",
se = FALSE) +
# geom_smooth(method = "loess",
#             se = FALSE) +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa()
main %>%
filter(time_span == "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
# stat_smooth(geom = "line",
#             method = "loess",
#             se = FALSE) +
geom_smooth(method = "loess",
se = FALSE) +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa()
?geom_smooth
main %>%
filter(time_span == "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
# stat_smooth(geom = "line",
#             method = "loess",
#             se = FALSE) +
geom_smooth() +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa()
main %>%
filter(time_span == "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
stat_smooth(geom = "line",
method = "loess",
se = FALSE) +
# geom_smooth() +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa()
main %>%
filter(time_span == "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
geom_smooth() +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa()
main %>%
filter(time_span == "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
geom_smooth() +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
ylim(0, 180) +
theme_apa()
main %>%
filter(time_span == "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
geom_smooth() +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa()
main %>%
filter(time_span == "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
scale_y_continuous(limit = c(0, 200))
geom_smooth() +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa()
main %>%
filter(time_span == "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
scale_y_continuous(limit = c(0, 200)) +
geom_smooth() +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa()
main %>%
filter(time_span == "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
geom_smooth() +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa()
main %>%
filter(time_span != "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
mutate(status = case_when(ID < 200 ~ "Unerfahren",
ID > 200 ~ "Erfahren"),
time_span = fct_recode(time_span,
"Pre-Lehrphase" = "pre",
"Lehrphase" = "main",
"Post-Lehrphase" = "subsequent",
"Interviewphase" = "interview",
"Endphase" = "after"
),
time_span = factor(time_span,
levels = c("Pre-Lehrphase",
"Lehrphase",
"Post-Lehrphase",
"Interviewphase",
"Endphase"
)
)
) %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
# stat_smooth(geom = "line",
# mapping = aes(color = status),
#            method = "loess",
#           se = TRUE)
geom_smooth(method = "glm") +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa() +
facet_grid(cols = vars(time_span),
scales = "free_x",
)
main %>%
filter(time_span != "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
mutate(status = case_when(ID < 200 ~ "Unerfahren",
ID > 200 ~ "Erfahren"),
time_span = fct_recode(time_span,
"Pre-Lehrphase" = "pre",
"Lehrphase" = "main",
"Post-Lehrphase" = "subsequent",
"Interviewphase" = "interview",
"Endphase" = "after"
),
time_span = factor(time_span,
levels = c("Pre-Lehrphase",
"Lehrphase",
"Post-Lehrphase",
"Interviewphase",
"Endphase"
)
)
) %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
# stat_smooth(geom = "line",
# mapping = aes(color = status),
#            method = "loess",
#           se = TRUE)
geom_smooth(method = "lm") +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa() +
facet_grid(cols = vars(time_span),
scales = "free_x",
)
main %>%
filter(time_span != "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
mutate(status = case_when(ID < 200 ~ "Unerfahren",
ID > 200 ~ "Erfahren"),
time_span = fct_recode(time_span,
"Pre-Lehrphase" = "pre",
"Lehrphase" = "main",
"Post-Lehrphase" = "subsequent",
"Interviewphase" = "interview",
"Endphase" = "after"
),
time_span = factor(time_span,
levels = c("Pre-Lehrphase",
"Lehrphase",
"Post-Lehrphase",
"Interviewphase",
"Endphase"
)
)
) %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
# stat_smooth(geom = "line",
# mapping = aes(color = status),
#            method = "loess",
#           se = TRUE)
geom_smooth(method = "loess") +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa() +
facet_grid(cols = vars(time_span),
scales = "free_x",
)
main %>%
filter(time_span != "overall") %>%
select("ID","time_span", "time","heart_rate") %>%
mutate(status = case_when(ID < 200 ~ "Unerfahren",
ID > 200 ~ "Erfahren"),
time_span = fct_recode(time_span,
"Pre-Lehrphase" = "pre",
"Lehrphase" = "main",
"Post-Lehrphase" = "subsequent",
"Interviewphase" = "interview",
"Endphase" = "after"
),
time_span = factor(time_span,
levels = c("Pre-Lehrphase",
"Lehrphase",
"Post-Lehrphase",
"Interviewphase",
"Endphase"
)
)
) %>%
distinct() %>%
ggplot(mapping = aes(x = time,
y = heart_rate
)
) +
# stat_smooth(geom = "line",
# mapping = aes(color = status),
#            method = "loess",
#           se = TRUE)
geom_smooth(method = "glm") +
scale_color_viridis_d(option = "A",
end = 0.8) +
scale_linetype_manual(values = c(1, 6)) +
labs(x = "Zeit (in Sekunden)",
y = "Herzrate (in Schlägen pro Minute)") +
theme_apa() +
facet_grid(cols = vars(time_span),
scales = "free_x",
)
View(main)
