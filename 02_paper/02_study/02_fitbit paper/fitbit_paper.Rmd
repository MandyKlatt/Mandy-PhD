---
title             : "New approaches to teachers' experience of stress: Do heart rate measurements with fitness trackers provide an efficient, inexpensive, and robust measurement method?"
shorttitle        : "Using fitbit to measure teachers' heart rate"

author: 
  - name          : "Mandy Klatt"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Dittrichring 5-7, 04109 Leipzig"
    email         : "mandy.klatt@uni-leipzig.de"
    role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
      - "Conceptualization"
      - "Writing - Original Draft Preparation"
      - "Writing - Review & Editing"
  - name          : "Peer Keßler"
    affiliation   : "1"
    role:
      - "Writing - Original Draft Preparation"
      - "Writing - Review & Editing"
  - name          : "Gregor Kachel"
    affiliation   : "1,2"
    role:
      - "Conceptualization"
      - "Writing - Original Draft Preparation"
      - "Writing - Review & Editing"
  - name          : "Christin Lotz"
    affiliation   : "1"
    role:
      - "Conceptualization"
      - "Writing - Original Draft Preparation"
      - "Writing - Review & Editing"
  - name          : "Anne Deiglmayr"
    affiliation   : "1"
    role:
      - "Supervision"

affiliation:
  - id            : "1"
    institution   : "Leipzig University"
  - id            : "2"
    institution   : "Max Planck Institute for Evolutionary Anthropology"

authornote: |
  We received funding from QualiFond of University Leipzig. We have no conflicts of interest to disclose. This article is based on data used at conference presentations (DACH-Nachwuchsakademie, 2022; EARLI SIG 11, 2022; EARLI SIG 27, 2022). 
 
abstract: |
  One or two sentences providing a **basic introduction** to the field,  comprehensible to a scientist in any discipline.
  
  Two to three sentences of **more detailed background**, comprehensible  to scientists in related disciplines.
  
  One sentence clearly stating the **general problem** being addressed by  this particular study.
  
  One sentence summarizing the main result (with the words "**here we show**" or their equivalent).
  
  Two or three sentences explaining what the **main result** reveals in direct comparison to what was thought to be the case previously, or how the  main result adds to previous knowledge.
  
  One or two sentences to put the results into a more **general context**.
  
  Two or three sentences to provide a **broader perspective**, readily comprehensible to a scientist in any discipline.
  
  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "heart rate; photoplethysmography; wearable electronic device; teaching"
wordcount         : "X"

bibliography      : "r-references.bib"

floatsintext      : no
linenumbers       : yes
draft             : no
mask              : no

figurelist        : no
tablelist         : no
footnotelist      : no

classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
library("papaja")
r_refs("r-references.bib")
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
```

```{r data wrangling, include=FALSE}

library(needs)
needs(ltm,
      broom,
      ppcor,
      jtools,
      lm.beta,
      tidyverse,
      janitor,
      lubridate,
      readxl,
      ggthemes,
      gridExtra,
      imputeTS,
      DescTools,
      cowplot,
      rstatix,
      ggpubr,
      lme4,
      viridis)

# disruption & confidence rating
df_rating <- 
  excel_sheets("data/Coding_SRI.xlsx") %>% 
  map_df(~read_xlsx("data/Coding_SRI.xlsx",.)) %>% # read in data with two sheets
  select(ID, # select relevant columns 
         disruption_factor, # -99 = subject did not notice event; -100 = experimenter did not asked for event
         confident_factor,
         event
         ) %>% 
  mutate(disruption_factor = ifelse(disruption_factor < 0,
                                    yes = NA,
                                    no = disruption_factor
                                    ),
         confident_factor = ifelse(confident_factor < 0,
                                   yes = NA,
                                   no = confident_factor),
         event = as_factor(event)
         )

# demographic data
df_demo_all <- 
  read_excel("./data/data_empschul_labor_lehrperson.xlsx") %>% # read in excel 
  transmute(ID = LI06_05, # select and rename relevant columns 
            # gender = factor(LI02_01_1,
            #                 levels = 1:2,
            #                 labels = c("male","female")
            #                 ),
            gender = LI02_01_1, # 1 = male; 2 = female
            age = LI03_01, 
            teaching_experience = LI04_01,
            school_type = LI18,
            term = LI11_01,
            extracurricular_teaching_experience = LI14,
            secondary_teaching_activities = LI17)

# merge two data frames by ID 
df_merge <- merge(df_demo_all,
                  df_rating,
                  by = "ID") %>% 
  filter(!ID %in% c("126", # exclude cases with no fitbit data (to check see data Heart Rate)
                    "132")
         )

# rm(list = c("df_demo","df_rating"))


data_path <- "./data/heart_rate_data"

main <-
map(.x = dir(path = data_path,
             pattern = ".csv"),
    ~ read_csv(file.path(data_path, .), 
               id = "id",
               col_types = c("t","n")
               ) %>% 
  mutate(time = .$Time - min(.$Time),
         time = as.numeric(time),
         heart_rate = `Heart Rate`,
         ID = id,
         time_span = case_when(str_detect(string = id, pattern = "_a") ~ "after",
           str_detect(string = id, pattern = "_m") ~ "main",
           str_detect(string = id, pattern = "_p") ~ "pre",
           str_detect(string = id, pattern = "_s") ~ "subsequent",
           str_detect(string = id, pattern = "_i") ~ "interview",
           TRUE ~ "overall"
           ),
         ID = str_extract(string = ID,
                          pattern = "[:digit:]{3}"),
         ID = as.numeric(ID)
      ) %>%
      filter(time <= 600) %>%
    select(!c("Time","Heart Rate","id"))
    ) %>%
  bind_rows()

main <-
  left_join(main, df_merge,
            by = "ID")

```

```{r, include=FALSE}
options(tinytex.verbose = TRUE)
```

# Introduction
Physiological data such as heart rate are becoming increasingly important in research on stress experience. They represent an important indicator of physical or emotional stress, as increased workload is associated with increased heart rate [@sachs2014physiologische]. Furthermore, they allow a more objective recording of stress than self-reports [@rungeusing]. However, capturing heart rate in an educational context requires the use of low-cost and non-invasive instruments. Fitness trackers worn on the wrist have the potential to be such a useful tool [@ferguson2015validity].

To date, there is still little evidence on the usefulness of heart rate measurements using fitness trackers in teaching and learning settings [@ertzberger2016use; @lowe2016educational]. @rungeusing alone examined teacher stress in a relatively small sample (*N* = 4 teachers) and showed that high heart rate, high step count, and little sleep indicate more stress in teachers.

Thus, there remains a lack of robust studies on whether fitness trackers are an efficient, inexpensive, and robust measurement method for assessing teachers' experience of stress. Since, among other things, greater professional experience is associated with lower feelings of stress in the teaching profession [@fisher2011factors], this study will also consider the heart rate measurements of experienced and inexperienced teachers.



## Aim of the study
Against this background, we investigated whether heart rate measurements using fitness trackers in a controlled teaching-learning setting are suitable to map differences between (1) anticipation, arousal, and rest phases. We expected heart rates to be higher in the arousal phase than in the rest phases.


# Methods
We report how we determined our sample size, all data exclusions (if any), all manipulations, and all measures in the study. <!-- 21-word solution (Simmons, Nelson & Simonsohn, 2012; retrieved from http://ssrn.com/abstract=2160588) -->

## Participants
```{r demographicstable, include = TRUE, echo=FALSE}

# exclude cases with no fitbit data
df_demo <- df_demo_all %>% 
  filter(!ID %in% c("126",
                     "132"
                     )
          )

# changing gender to count female gender (male = 2 --> 0)
df_demo$gender = ifelse(df_demo$gender == 2, "1","0")

# changing character Gender into numeric
df_demo$gender <- as.numeric(df_demo$gender)

# creating new column with total participants to calculate percent of gender
df_demo <- df_demo %>%
  mutate(sum_participants = sum(n()))

# replacing 2 to 1 (Oberschule = Gymnasisium --> Secondary school)
df_demo$school_type[df_demo$school_type == 2] <- "1"

# creating new column to calculate percent of school type
df_demo <- 
  df_demo %>%
  group_by(school_type) %>%
  mutate(count_schooltype = sum(n())) %>% 
  mutate(percent_schooltype = round((count_schooltype/sum_participants) * 100, 
         digits = 2))

# changing character Percent_schooltype into numeric
df_demo$percent_schooltype <- as.numeric(df_demo$percent_schooltype)

#changing type of school into character
# LI18:
# 1: Grundschule
# 2: Oberschule
# 3: Gymnasium
# 4: Förderschule/Sondershausen
# 5: Berufsbildende Schule
# -1: andere Schulform
df_demo$school_type <- factor(x = df_demo$school_type,
                              levels = c("1","3","4","5","-1"), # Mögliche Werte # andere Möglichkeit: unique(demo.data$School_type)
                              labels = c("Primary School","Secondary School", "Special Education","Vocational School", "Other Schooltype")) # Bezeichnungen


# create a basic table (tibble) using tidyverse functions
df_demo_table <- df_demo %>%
  ungroup() %>%
  summarise(N=n(),
            "Gender female in percent" = round(sum(gender/sum_participants) * 100,
                                               digits = 2),
            "M Age in years" = round(mean(age),
                                     digits = 2),
            "SD Age in years" = round(sd(age),
                                      digits = 2),
            "Min Age in years" = min(age),
            "Max Age in years" = max(age),
            "M Teaching Experience in years" = round(mean(teaching_experience),
                                            digits = 2),
            "SD Teaching Experience in years" = round(sd(teaching_experience),
                                            digits = 2),
            "Min Teaching Experience in years" = min(teaching_experience),
            "Max Teaching Experience in years" = max(teaching_experience)
            )

# # format and insert table in manuscript
# df_demo_table %>%
# papaja::apa_table(
#   caption = "Demographic Information",
#   # note = "Write Note here",
#   escape = TRUE, # if TRUE special Latex characters are escaped; if this is turned to F captions cannot be rendered. I don't know why...
#   placement = "h", # position of table in page:  exact location (h), at the top (t), bottom (b)
#   font_size = "tiny" # options are tiny, scriptsize, footnotesize, small, normalsize (default), large, Large, LARGE, huge, Huge
#   )
      

```

The sample consisted in total of *N* = `r length(df_demo_all$ID)` pre- and in-service teachers. The subjects were recruited from the Leipzig University or from German schools in Saxony via personal contact, e-mail lists and flyers. Data of two participants were excluded from the analyses due to insufficient data quality, yielding data from *N* = `r length(df_demo$ID)` subjects.

The subjects (`r df_demo %>% filter(gender == 1) %>% pull(gender) %>% length()` women; `r df_demo_table %>% pull("Gender female in percent")` %) had a mean age of `r df_demo %>% pull(age) %>% mean() %>% round(., digits = 1)` years (*SD* = `r df_demo_table %>% pull("SD Age in years") %>% round(., digits = 1)`; range: `r df_demo_table %>%  pull("Min Age in years")`-`r df_demo_table %>% pull("Max Age in years")`) and an average teaching experience of `r df_demo_table %>% pull("M Teaching Experience in years")` years (*SD* = `r df_demo_table %>% pull("SD Teaching Experience in years")`; range: `r df_demo_table %>% pull("Min Teaching Experience in years")`-`r df_demo_table %>% pull("Max Teaching Experience in years")`). 

`r df_demo %>% filter(school_type == "Primary School") %>% pull("percent_schooltype") %>% unique()`% of the subjects were (studying to become) teachers for primary school, `r df_demo %>% filter(school_type == "Secondary School") %>% pull("percent_schooltype") %>% unique()`% were (studying to become) teachers for secondary school and  `r df_demo %>% filter(school_type == "Special Education") %>% pull("percent_schooltype") %>% unique()`% were (studying to become) teachers for special education needs.

All study procedures were carried out in accordance with the ethical standards of the University’s Institutional Review Board and the authors received a positive vote on the study procedures from the Ethics Committee Board of Leipzig University. All participants were informed in detail about the aim and intention of the study prior to testing. Participation in the study was voluntary and only took place after written consent has been given.


## Material

### Teachers' heart rate
We used a Fitbit Charge 4 to measure the teachers' heart rate. The device was attached 2-finger widths above the ulnar styloid process to the subject’s wrist following the manufacturer’s instructions. To determine the heart rate, the Fitbit flashes green LEDs many times per second and uses light-sensitive photodiodes to measure the volume changes in the capillaries and then calculates how many times the heart beats per minute (bpm). Data were automatically wireless synced with an iPad via Bluetooth to a Fitbit account, and subsequently, the intraday second-by-second data were exported for each session using the opensource software Pulse Watch (PulseWatch. URL: https://iccir919.github.io/pulseWatch/public/index.html [accessed 2022-08-03]).

### Teachers' self-assessment of arousal during the teaching phase
The subject's self-assessment of arousal in response to the nine disruptions during the lesson was assessed in a Stimulated Recall Interview that took place after the lesson. For this purpose, two numerical 11-point rating scales were used: _(1)_	The first rating scale collected data of the teacher's subjective perception of disruptiveness of each disruption with the following question: "On a scale of 0-10: how disruptive did you find the event? 0 is not disruptive at all, 10 is extremely disruptive" _(2)_	The second rating scale assessed the teacher’s subjective perception of confidence in dealing with the disruptions during the lesson asked as follows: "How confident did you feel in dealing with this event on a scale of 0-10? 0 is not confident at all and 10 is extremely confident"
The response format was purposely chosen to be closed and with several answer options in order to assign numerical values to the subjetcts' self-assessment and emotional experience, and thus to make them measurable and comparable [@eid2015statistik; @doring2016empirische]. The gradations of the rating scale were unambiguous and the intervals between them identical. The characteristic value was estimated by the subjects immediately after seeing the recording of the respective disruption and communicated verbally to the experimenter.



## Procedure

The data collection was part of a larger research project with a planned sample of *n* = 40 in-service teachers and *n* = 40 pre-service teachers. 

In a controlled laboratory setting, heart rate data in beats per minute (bpm) were recorded using Fitbit Charge 4 over a total period of approximately two hours. Within this time frame, teachers taught a 15-minute self-prepared lesson to an audience of three actors. For analyzing the heart rate data, we selected five 10-minute intervals of theoretical interest: 
(1) the pre-teaching phase, which started from the moment the subject put on the watch 
(2) the teaching phase, which began at the moment when the subject started the lesson 
(3) the post-teaching phase, which was the 10 minutes immediately after the end of the lesson
(4) the interview phase, which was 10 minutes in the middle of the interview (for this, the difference was calculated from the end of the lesson and from the time when the subject took off the watch. This duration was divided in two to get to the middle of the interval and 5 minutes were subtracted to get to the start of the 10-minute interval),
(5) the end phase, which was the 10 minutes before the subject took off the watch.

In a laboratory setting, three trained actors performed teaching disruptions in a counter balanced fashion while the subject taught a 15-minute micro-teaching unit prepared in advance. To record the subject's heart rate, the Fitbit Charge 4 was put on at least 10 minutes before the start of the lesson. The lesson was recorded by four cameras and an audio recorder. In addition, the subject wore eye-tracking glasses to record gaze behavior. 

Subsequently, the subjects as well as the actors were given a short questionnaire, which contained items to collect demographic information as well as items about the previously given lesson on teaching quality using a validated questionnaire (EMU, @helmke2014unterrichtsdiagnostik) and self developed scales on the teacher's presence behavior derived from the research literature via the online survey website SoSci Survey (4-point Likert scale; 1 = strongly disagree; 2 = disagree; 3 = agree; 4 = strongly agree). The completion of the questionnaire took approximately 5 minutes. 

The experimenter then conducted a Stimulated Recall Interview (SRI), where the subject commented and rated the reactions to classroom events while watching the eye tracking video.

Finally, a Situational Judgment Test (SJT, @gold2015development) was used to assess the subject's strategic knowledge of classroom management. The subject was asked to judge alternative actions on school scenarios on a 6-point rating scale from 1 (A) to 6 (F) according to school grades. Data from the SJT were again collected as an online questionnaire via the website www.soscisurvey.de and lastet approximately 10 minutes. 

The Fitbit watch was removed only after the last questionnaire to obtain heart rate data during the entire study.

## Data analysis
We used `r cite_r("r-references.bib")` for all our analyses.

### FitBit

All participants were given a FitBit Smart Watch Charge 4 to wear during the experiment. 

## Heart Rate



# Results

# Discussion and implication


\newpage

# References

::: {#refs custom-style="Bibliography"}
:::
