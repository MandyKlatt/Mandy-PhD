) +
facet_grid(cols = vars(Type)) +
aes(fill = Type)
grid.arrange(plot_flow, plot_box,
ncol = 1)
?get_legend
needs(tidyverse,
lubridate,
viridis,
gridExtra,
ggpubr)
library(needs)
needs(tidyverse,
lubridate,
viridis,
gridExtra,
ggpubr)
get_legend(plot_flow_leg, position = "right")
plot_flow_leg <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
theme_minimal() +
theme(text = element_text(family = "serif"))
m101 <- read_csv(file = "Data/101_m.csv")
m102 <- read_csv(file = "Data/102_m.csv")
m103 <- read_csv(file = "Data/103_m.csv")
m104 <- read_csv(file = "Data/104_m.csv")
m105 <- read_csv(file = "Data/105_m.csv")
p101 <- read_csv(file = "Data/101_p.csv")
p102 <- read_csv(file = "Data/102_p.csv")
p103 <- read_csv(file = "Data/103_p.csv")
p104 <- read_csv(file = "Data/104_p.csv")
p105 <- read_csv(file = "Data/105_p.csv")
a101 <- read_csv(file = "Data/101_a.csv")
a102 <- read_csv(file = "Data/102_a.csv")
a103 <- read_csv(file = "Data/103_a.csv")
a104 <- read_csv(file = "Data/104_a.csv")
a105 <- read_csv(file = "Data/105_a.csv")
z <- ls()
m101$Time <- m101$Time - min(m101$Time)
m102$Time <- m102$Time - min(m102$Time)
m103$Time <- m103$Time - min(m103$Time)
m104$Time <- m104$Time - min(m104$Time)
m105$Time <- m105$Time - min(m105$Time)
p101$Time <- p101$Time - min(p101$Time)
p102$Time <- p102$Time - min(p102$Time)
p103$Time <- p103$Time - min(p103$Time)
p104$Time <- p104$Time - min(p104$Time)
p105$Time <- p105$Time - min(p105$Time)
a101$Time <- a101$Time - min(a101$Time)
a102$Time <- a102$Time - min(a102$Time)
a103$Time <- a103$Time - min(a103$Time)
a104$Time <- a104$Time - min(a104$Time)
a105$Time <- a105$Time - min(a105$Time)
m101$ID <- 101
p101$ID <- 101
a101$ID <- 101
m102$ID <- 102
p102$ID <- 102
a102$ID <- 102
m103$ID <- 103
p103$ID <- 103
a103$ID <- 103
m104$ID <- 104
p104$ID <- 104
a104$ID <- 104
m105$ID <- 105
p105$ID <- 105
a105$ID <- 105
df_main <- bind_rows(m101, m102, m103, m104, m105)
df_prior <- bind_rows(p101, p102, p103, p104, p105)
df_after <- bind_rows(a101, a102, a103, a104, a105)
rm(list = as.character(z))
rm(z)
df_after$Type <- "Post"
df_main$Type <- "Main"
df_prior$Type <- "Pre"
df_all <- bind_rows(df_prior, df_main, df_after)
df_all <- df_all %>%
mutate(Type = as_factor(Type),
ID = as_factor(ID)
)
df_aggr <- df_all %>%
group_by(Type, ID) %>%
summarise(mean = mean(`Heart Rate`))
plot_flow <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
labs(x = "Time (in Seconds)",
y = "Heart Rate\n(in Beats per Minute)") +
theme_minimal() +
theme(text = element_text(family = "serif"),
legend.position = "none") +
facet_grid(cols = vars(Type))
plot_flow_leg <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
theme_minimal() +
theme(text = element_text(family = "serif"))
get_legend(plot_flow_leg, position = "right")
plot_flow
get_legend(plot_flow_leg, position = "right")
legend <- get_legend(plot_flow_leg, position = "right")
plot_flow <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
labs(x = "Time (in Seconds)",
y = "Heart Rate\n(in Beats per Minute)") +
theme_minimal() +
theme(text = element_text(family = "serif"),
legend.position = "none") +
facet_grid(cols = vars(Type))
plot_flow_leg <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
theme_minimal() +
theme(text = element_text(family = "serif"))
legend <- get_legend(plot_flow_leg, position = "right")
plot_flow
plot_box <-
ggplot(data = df_aggr,
mapping = aes(x = factor(0),
y = mean
)
) +
geom_boxplot() +
geom_point(size = 2,
position = position_jitter(seed = 1,
width = 0.1
),
color = "#000004FF"
) +
labs(x = "",
y = "Average Heart Rate\n(in Beats per Minute)") +
scale_fill_viridis_d(option = "A",
end = 0.8,
begin = 0.2) +
theme_minimal() +
theme(text = element_text(family = "serif"),
axis.text.x = element_blank(),
legend.position = "none"
) +
facet_grid(cols = vars(Type)) +
aes(fill = Type)
plot_box
?grid.arrange
lo_mat <- matrix(c(1,1,1,3,2,2,2,3),
nrow = 2,
byrow = T)
lo_mat
grid.arrange(plot_flow, plot_box, legend,
layout_matix = lo_mat,
ncol = 4)
legend <- get_legend(plot_flow_leg)
plot_flow_leg <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
labs(x = "Time (in Seconds)",
y = "Heart Rate\n(in Beats per Minute)") +
theme_minimal() +
theme(text = element_text(family = "serif"),
legend.position = "none") +
facet_grid(cols = vars(Type))
legend <- get_legend(plot_flow_leg)
plot_flow_leg <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
labs(x = "Time (in Seconds)",
y = "Heart Rate\n(in Beats per Minute)") +
theme_minimal() +
theme(text = element_text(family = "serif")) +
facet_grid(cols = vars(Type))
legend <- get_legend(plot_flow_leg)
legend
plot_flow_leg
as.numeric(df_all$Time)
legend <- get_legend(plot_flow_leg)
grid.arrange(plot_flow, plot_box, as.list(legend),
layout_matix = lo_mat,
ncol = 4)
legend
needs(tidyverse,
lubridate,
viridis,
gridExtra,
cowplot)
legend <- cowplot::get_legend(plot_flow_leg)
legend
grid.draw(legend)
needs(tidyverse,
lubridate,
viridis,
grid,
gridExtra,
cowplot)
grid.draw(legend)
grid.arrange(plot_flow, plot_box, grid.draw(legend),
layout_matix = lo_mat,
ncol = 4)
plot_flow <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
labs(x = "Time (in Seconds)",
y = "Heart Rate\n(in Beats per Minute)") +
theme_minimal() +
theme(text = element_text(family = "serif"),
legend.position = "none") +
facet_grid(cols = vars(Type))
plot_flow_leg <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
labs(x = "Time (in Seconds)",
y = "Heart Rate\n(in Beats per Minute)") +
theme_minimal() +
theme(text = element_text(family = "serif")) +
facet_grid(cols = vars(Type))
legend <- cowplot::get_legend(plot_flow_leg)
plot_flow
plot_box <-
ggplot(data = df_aggr,
mapping = aes(x = factor(0),
y = mean
)
) +
geom_boxplot() +
geom_point(size = 2,
position = position_jitter(seed = 1,
width = 0.1
),
color = "#000004FF"
) +
labs(x = "",
y = "Average Heart Rate\n(in Beats per Minute)") +
scale_fill_viridis_d(option = "A",
end = 0.8,
begin = 0.2) +
theme_minimal() +
theme(text = element_text(family = "serif"),
axis.text.x = element_blank(),
legend.position = "none"
) +
facet_grid(cols = vars(Type)) +
aes(fill = Type)
plot_box
lo_mat <- matrix(c(1,1,1,3,2,2,2,3),
nrow = 2,
byrow = T)
grid.arrange(plot_flow, plot_box, grid.draw(legend),
layout_matix = lo_mat,
ncol = 4)
legend <- grid.draw(legend)
grid.arrange(plot_flow, plot_box, legend,
layout_matix = lo_mat,
ncol = 4)
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matix = lo_mat,
ncol = 4)
legend <- cowplot::get_legend(plot_flow_leg)
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matix = lo_mat,
ncol = 4)
lo_mat <- matrix(c(1,1,1,3,2,2,2,3),
nrow = 2,
byrow = T)
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matix = lo_mat,
ncol = 4)
View(lo_mat)
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matix = lo_mat,
ncol = 2)
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matix = lo_mat)
View(lo_mat)
?grid.arrange
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matix = lo_mat,
ncol = 3)
lo_mat <- rbind(c(1,1,1,1,3),
c(2,2,2,2,NA))
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matix = lo_mat)
View(lo_mat)
grid.arrange(grobs = list(plot_flow, plot_box, legend))
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matrix = lo_mat)
lo_mat <- rbind(c(1,1,1,1,1,1,3),
c(2,2,2,2,2,2,NA))
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matrix = lo_mat)
plot_box <-
ggplot(data = df_aggr,
mapping = aes(x = factor(0),
y = mean
)
) +
geom_boxplot() +
geom_point(size = 2,
position = position_jitter(seed = 1,
width = 0.1
),
color = "#000004FF"
) +
labs(x = "",
y = "Average Heart Rate\n(in Beats per Minute)") +
scale_fill_viridis_d(option = "A",
end = 0.8,
begin = 0.2) +
theme_minimal() +
theme(text = element_text(family = "serif"),
axis.text.x = element_blank(),
legend.position = "none",
strip.text = element_blank()
) +
facet_grid(cols = vars(Type)) +
aes(fill = Type)
plot_box
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matrix = lo_mat)
#plot_flow <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
labs(x = "Time (in Seconds)",
y = "Heart Rate\n(in Beats per Minute)") +
theme_minimal() +
theme(text = element_text(family = "serif"),
legend.position = "none",
strip.text = element_text(size = 1)) +
facet_grid(cols = vars(Type))
#plot_flow <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
labs(x = "Time (in Seconds)",
y = "Heart Rate\n(in Beats per Minute)") +
theme_minimal() +
theme(text = element_text(family = "serif"),
legend.position = "none",
strip.text = element_text(size = 4)) +
facet_grid(cols = vars(Type))
#plot_flow <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
labs(x = "Time (in Seconds)",
y = "Heart Rate\n(in Beats per Minute)") +
theme_minimal() +
theme(text = element_text(family = "serif"),
legend.position = "none",
strip.text = element_text(size = 20)) +
facet_grid(cols = vars(Type))
plot_flow <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
labs(x = "Time (in Seconds)",
y = "Heart Rate\n(in Beats per Minute)") +
theme_minimal() +
theme(text = element_text(family = "serif"),
legend.position = "none",
strip.text = element_text(size = 20)) +
facet_grid(cols = vars(Type))
plot_fitbit <-
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matrix = lo_mat)
plot_flow <-
ggplot(data = df_all,
mapping = aes(x = Time,
y = `Heart Rate`
)
) +
geom_line(mapping = aes(color = ID)) +
scale_color_viridis_d(option = "A",
end = 0.8) +
labs(x = "Time (in Seconds)",
y = "Heart Rate\n(in Beats per Minute)") +
theme_minimal() +
theme(text = element_text(family = "serif"),
legend.position = "none",
strip.text = element_text(size = 16)) +
facet_grid(cols = vars(Type))
plot_fitbit <-
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matrix = lo_mat)
plot_box
ggsave(plot = plot_fitbit,
file = "Plots/fitbit.pdf",
height = 11,
width = 15,
)
ggsave(plot = plot_fitbit,
file = "Plots/fitbit.pdf",
height = 11,
width = 15,
units = "cm"
)
ggsave(plot = plot_fitbit,
file = "Plots/fitbit.pdf",
height = 16,
width = 20,
units = "cm"
)
plot_box <-
ggplot(data = df_aggr,
mapping = aes(x = factor(0),
y = mean
)
) +
geom_boxplot() +
geom_point(size = 2,
position = position_jitter(seed = 1,
width = 0.1
),
color = "#000004FF"
) +
labs(x = "",
y = "Average Heart Rate\n(in Beats per Minute)") +
scale_fill_viridis_d(option = "A",
end = 0.8,
begin = 0.3) +
theme_minimal() +
theme(text = element_text(family = "serif"),
axis.text.x = element_blank(),
legend.position = "none",
strip.text = element_blank()
) +
facet_grid(cols = vars(Type)) +
aes(fill = Type)
plot_fitbit <-
grid.arrange(grobs = list(plot_flow, plot_box, legend),
layout_matrix = lo_mat)
ggsave(plot = plot_fitbit,
file = "Plots/fitbit.pdf",
height = 16,
width = 20,
units = "cm"
)
